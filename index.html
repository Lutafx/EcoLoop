<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoLoop - Платформа для отелей | Управление отходами</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Manrope:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&display=swap');
        
        * {
            font-family: 'Manrope', 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0a0a0a;
            color: #e5e5e5;
            overflow-x: hidden;
        }
        
        /* Статичный тёмный фон */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: #0a0a0a;
        }

        /* Canvas частиц */
        .particles-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        
        /* Градиентный текст - Quietude зеленый */
        .gradient-text {
            background: linear-gradient(135deg, #8EA99A, #A8C5B5, #8EA99A);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 8s ease infinite;
        }
        
        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* Темный glass эффект стартапа */
        .glass-effect {
            background: rgba(18, 18, 18, 0.8);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(142, 169, 154, 0.1);
            box-shadow: 
                0 4px 24px 0 rgba(0, 0, 0, 0.5),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.05);
        }
        
        /* Темные карточки стартапа */
        .mirror-card {
            position: relative;
            background: #1a1a1a;
            border: 1px solid rgba(142, 169, 154, 0.15);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
        }
        
        .mirror-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent
            );
            transition: left 0.5s;
        }
        
        .mirror-card:hover::before {
            left: 100%;
        }
        
        .mirror-card::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(16, 185, 129, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s;
        }
        
        .mirror-card:hover::after {
            opacity: 1;
        }
        
        .mirror-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(142, 169, 154, 0.15);
            border-color: rgba(142, 169, 154, 0.4);
        }
        
        /* Ripple эффект при клике */
        @keyframes ripple-anim {
            0% { transform: scale(0); opacity: 0.5; }
            100% { transform: scale(4); opacity: 0; }
        }
        .ripple-effect { position: relative; overflow: hidden; }
        .ripple-effect .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255,255,255,0.35);
            width: 100px; height: 100px;
            margin-top: -50px; margin-left: -50px;
            animation: ripple-anim 0.6s ease-out;
            pointer-events: none;
        }

        /* Премиум кнопки */
        .btn-gradient {
            position: relative;
            background: linear-gradient(135deg, #8EA99A, #A8C5B5);
            border: none;
            overflow: hidden;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: none;
            cursor: pointer;
        }
        .btn-gradient:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(142, 169, 154, 0.35), 0 0 40px rgba(142,169,154,0.12);
        }
        .btn-gradient:active {
            transform: translateY(0) scale(0.97);
            box-shadow: 0 2px 10px rgba(142, 169, 154, 0.2), inset 0 0 12px rgba(255,255,255,0.15);
        }

        /* Кнопка контурная */
        .btn-outline {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.15);
            color: #fff;
            cursor: pointer;
            transition: all 0.25s ease;
            position: relative;
            overflow: hidden;
        }
        .btn-outline:hover {
            border-color: rgba(142,169,154,0.5);
            background: rgba(142,169,154,0.06);
            box-shadow: 0 0 20px rgba(142,169,154,0.12);
            transform: translateY(-2px) scale(1.02);
        }
        .btn-outline:active {
            transform: scale(0.97);
            background: rgba(142,169,154,0.12);
        }

        /* Анимированный градиент для hero */
        .hero-accent {
            background: linear-gradient(90deg, #8EA99A, #5B8291, #F2C94C, #8EA99A);
            background-size: 300% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: hero-flow 6s ease infinite;
        }
        @keyframes hero-flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Sticky header */
        .header-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
            transition: all 0.3s ease;
        }
        .header-sticky.scrolled {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.5);
        }

        /* Focus glow на инпутах */
        input:focus, select:focus, textarea:focus {
            box-shadow: 0 0 0 2px rgba(142,169,154,0.2) !important;
        }

        /* Scroll to top */
        .scroll-top-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: rgba(142,169,154,0.15);
            border: 1px solid rgba(142,169,154,0.2);
            color: #8EA99A;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 50;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .scroll-top-btn:hover {
            background: rgba(142,169,154,0.25);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(142,169,154,0.15);
        }

        /* Toast */
        @keyframes slideInRight {
            from { transform: translateX(120%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(120%); opacity: 0; }
        }
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 200;
            background: #1a1a1a;
            border: 1px solid rgba(142,169,154,0.2);
            border-radius: 14px;
            padding: 14px 20px;
            animation: slideInRight 0.4s ease;
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
        }
        .toast.hiding { animation: slideOutRight 0.3s ease forwards; }

        /* Мобильное меню */
        .mobile-menu {
            position: fixed;
            inset: 0;
            z-index: 90;
            background: rgba(10,10,10,0.97);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 32px;
            animation: fadeIn 0.3s ease;
        }

        /* FAQ accordion */
        .faq-item {
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.02);
        }
        .faq-item:hover { border-color: rgba(255,255,255,0.12); }
        .faq-item.open { border-color: rgba(142,169,154,0.25); }
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.3s ease;
        }
        .faq-item.open .faq-answer { max-height: 200px; }

        /* Карточки с подсветкой при клике */
        .card-clickable {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .card-clickable:active {
            transform: scale(0.98);
            box-shadow: inset 0 0 20px rgba(142,169,154,0.1);
        }

        /* Модалка Terms */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(4px);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: #141414;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .modal-scroll {
            overflow-y: auto;
            flex: 1;
            padding: 24px;
            max-height: 50vh;
        }
        .modal-scroll::-webkit-scrollbar { width: 4px; }
        .modal-scroll::-webkit-scrollbar-thumb { background: #8EA99A; border-radius: 4px; }
        
        /* Светящиеся границы стартапа */
        .glow-border {
            position: relative;
            border: 2px solid transparent;
            background: linear-gradient(135deg, #1a1a1a, #121212) padding-box,
                        linear-gradient(135deg, #8EA99A, #5B8291) border-box;
            border-radius: 24px;
            box-shadow: 0 8px 40px rgba(142, 169, 154, 0.15);
        }
        
        /* Анимация появления */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Статистические карточки - Темный Bento */
        .stat-card {
            position: relative;
            background: #1a1a1a;
            border: 1px solid rgba(91, 130, 145, 0.2);
            border-radius: 16px;
            padding: 28px;
            overflow: hidden;
            transition: all 0.4s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, #8EA99A, #5B8291, transparent);
            animation: shimmer 4s infinite;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            border-color: rgba(142, 169, 154, 0.35);
            box-shadow: 0 6px 24px rgba(142, 169, 154, 0.12);
        }
        
        /* Скроллбар */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #8EA99A, #5B8291);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #8EA99A;
        }
        
        /* Плавающие элементы */
        .float-element {
            animation: float 6s ease-in-out infinite;
        }
        
        /* Пульсирующий эффект */
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 0 0 30px rgba(142, 169, 154, 0.2);
            }
            50% {
                box-shadow: 0 0 50px rgba(142, 169, 154, 0.4);
            }
        }
        
        /* Кнопка выбора роли - темная */
        .role-button {
            position: relative;
            background: #1a1a1a;
            border: 2px solid rgba(142, 169, 154, 0.2);
            border-radius: 20px;
            padding: 36px;
            transition: all 0.4s ease;
            cursor: pointer;
        }
        
        .role-button:hover {
            border-color: #8EA99A;
            box-shadow: 0 8px 28px rgba(142, 169, 154, 0.2);
            transform: translateY(-4px);
        }
        
        .role-button.active {
            border-color: #8EA99A;
            background: linear-gradient(135deg, rgba(142, 169, 154, 0.1), rgba(91, 130, 145, 0.1));
            box-shadow: 0 8px 28px rgba(142, 169, 154, 0.25);
        }
        
        /* Поле загрузки фото */
        .upload-area {
            border: 2px dashed rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(255,255,255,0.03);
        }
        
        .upload-area:hover {
            border-color: #8EA99A;
            background: rgba(142, 169, 154, 0.05);
        }
        
        .upload-area.dragover {
            border-color: #8EA99A;
            background: rgba(142, 169, 154, 0.1);
        }

        /* Премиум заголовки секций */
        .section-label {
            font-family: 'Space Grotesk', 'Manrope', sans-serif;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 6px 16px;
            border-radius: 100px;
            border: 1px solid rgba(142,169,154,0.15);
            background: rgba(142,169,154,0.06);
            color: #8EA99A;
            margin-bottom: 20px;
        }
        .section-label::before {
            content: '';
            display: block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #8EA99A;
            box-shadow: 0 0 8px rgba(142,169,154,0.5);
        }
        .section-title {
            font-family: 'Space Grotesk', 'Manrope', sans-serif;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        /* Callback форма */
        .callback-card {
            background: linear-gradient(135deg, rgba(142,169,154,0.06), rgba(91,130,145,0.04));
            border: 1px solid rgba(142,169,154,0.12);
            border-radius: 24px;
            padding: 48px;
            position: relative;
            overflow: hidden;
        }
        .callback-card::before {
            content: '';
            position: absolute;
            top: -40%;
            right: -20%;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(142,169,154,0.08) 0%, transparent 70%);
            pointer-events: none;
        }

        /* Animated counter */
        .counter-value {
            font-family: 'Space Grotesk', monospace;
            font-variant-numeric: tabular-nums;
        }

        /* Партнёры */
        .partner-badge {
            padding: 12px 28px;
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,0.06);
            background: rgba(255,255,255,0.02);
            font-size: 14px;
            font-weight: 600;
            color: rgba(255,255,255,0.5);
            transition: all 0.3s ease;
        }
        .partner-badge:hover {
            border-color: rgba(142,169,154,0.2);
            color: rgba(255,255,255,0.8);
        }
        
        /* Плавные переходы при скролле */
        .reveal {
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .reveal-delay-1 { transition-delay: 0.1s; }
        .reveal-delay-2 { transition-delay: 0.2s; }
        .reveal-delay-3 { transition-delay: 0.3s; }
        .reveal-delay-4 { transition-delay: 0.4s; }

        html { scroll-behavior: smooth; }

        /* Sunny желтая кнопка-акцент */
        .btn-gold {
            background: linear-gradient(135deg, #F2C94C, #FFD666);
            color: #0a0a0a;
            font-weight: 800;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(242, 201, 76, 0.4);
        }
        
        .btn-gold:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 35px rgba(242, 201, 76, 0.5);
        }

        /* Hover glow для карточек и интерактивных элементов */
        .hover-glow {
            transition: all 0.35s cubic-bezier(0.4,0,0.2,1);
        }
        .hover-glow:hover {
            border-color: rgba(142,169,154,0.25) !important;
            box-shadow: 0 0 30px rgba(142,169,154,0.06), 0 8px 32px rgba(0,0,0,0.15);
            transform: translateY(-3px);
        }

        /* Навигация hover */
        .nav-link {
            position: relative;
            transition: color 0.2s ease;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #8EA99A, #5B8291);
            transition: width 0.3s ease;
            border-radius: 1px;
        }
        .nav-link:hover::after {
            width: 100%;
        }

        /* Chart container */
        .chart-container {
            position: relative;
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: 20px;
            padding: 24px;
        }

        /* Admin badge */
        .status-badge {
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 100px;
            letter-spacing: 0.02em;
        }
        .status-active { background: rgba(52,211,153,0.12); color: #34d399; }
        .status-pending { background: rgba(251,191,36,0.12); color: #fbbf24; }
        .status-rejected { background: rgba(239,68,68,0.12); color: #ef4444; }

        /* Tab buttons */
        .tab-btn {
            padding: 8px 20px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s ease;
            color: rgba(255,255,255,0.4);
            background: transparent;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .tab-btn:hover { color: rgba(255,255,255,0.7); }
        .tab-btn.active {
            background: rgba(142,169,154,0.1);
            color: #8EA99A;
            border-color: rgba(142,169,154,0.15);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Главное приложение
        function App() {
            const [currentPage, setCurrentPage] = useState('landing');
            const [userRole, setUserRole] = useState(null);
            const [selectedLot, setSelectedLot] = useState(null);

            const navigate = (page, data = null) => {
                setCurrentPage(page);
                if (data) setSelectedLot(data);
            };

            const selectRole = (role) => {
                setUserRole(role);
                if (role === 'buyer') {
                    setCurrentPage('buyer-register');
                } else {
                    setCurrentPage('hotel-request');
                }
            };

            return (
                <div>
                    {currentPage === 'role-select' && <RoleSelect selectRole={selectRole} navigate={navigate} />}
                    {currentPage === 'buyer-register' && <BuyerRegister navigate={navigate} />}
                    {currentPage === 'hotel-request' && <HotelRequestForm navigate={navigate} />}
                    {currentPage === 'landing' && <Landing navigate={navigate} />}
                    {currentPage === 'marketplace' && <Marketplace navigate={navigate} />}
                    {currentPage === 'requests' && <Requests navigate={navigate} />}
                    {currentPage === 'dashboard' && <Dashboard navigate={navigate} />}
                    {currentPage === 'create-lot' && <CreateLot navigate={navigate} />}
                    {currentPage === 'create-request' && <CreateRequest navigate={navigate} />}
                    {currentPage === 'lot-detail' && <LotDetail navigate={navigate} lot={selectedLot} />}
                    {currentPage === 'payouts' && <SellerPayouts navigate={navigate} />}
                    {currentPage === 'admin' && <AdminPanel navigate={navigate} />}
                    {currentPage === 'buyer-profile' && <BuyerProfile navigate={navigate} />}
                    {currentPage === 'analytics' && <Analytics navigate={navigate} />}
                </div>
            );
        }

        // Ripple эффект при клике
        function addRipple(e) {
            const btn = e.currentTarget;
            const rect = btn.getBoundingClientRect();
            const ripple = document.createElement('span');
            ripple.className = 'ripple';
            ripple.style.left = (e.clientX - rect.left) + 'px';
            ripple.style.top = (e.clientY - rect.top) + 'px';
            btn.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);
        }

        // Toast уведомления
        function Toast({ message, type = 'success', onClose }) {
            useEffect(() => {
                const t = setTimeout(onClose, 3000);
                return () => clearTimeout(t);
            }, []);
            return (
                <div className="toast">
                    <div className="flex items-center gap-3">
                        <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${type === 'success' ? 'bg-emerald-500/20' : 'bg-red-500/20'}`}>
                            {type === 'success'
                                ? <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>
                                : <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ef4444" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                            }
                        </div>
                        <span className="text-sm text-white font-medium">{message}</span>
                    </div>
                </div>
            );
        }

        // Scroll to top кнопка
        function ScrollToTop() {
            const [visible, setVisible] = useState(false);
            useEffect(() => {
                const onScroll = () => setVisible(window.scrollY > 400);
                window.addEventListener('scroll', onScroll);
                return () => window.removeEventListener('scroll', onScroll);
            }, []);
            if (!visible) return null;
            return (
                <button className="scroll-top-btn" onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="18 15 12 9 6 15"/></svg>
                </button>
            );
        }

        // Частицы фон — улучшенные
        function ParticlesBackground() {
            const canvasRef = useRef(null);
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                let animId;
                const resize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
                resize();
                window.addEventListener('resize', resize);
                const colors = [
                    [142, 169, 154], // quietude green
                    [91, 130, 145],  // mapped blue
                    [142, 169, 154], // green
                    [200, 200, 180], // warm white
                    [242, 201, 76],  // gold (rare)
                ];
                const particles = Array.from({length: 70}, () => {
                    const c = colors[Math.random() < 0.08 ? 4 : Math.floor(Math.random() * 4)];
                    return {
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        r: Math.random() * 2 + 0.4,
                        dx: (Math.random() - 0.5) * 0.25,
                        dy: (Math.random() - 0.5) * 0.25,
                        o: Math.random() * 0.25 + 0.08,
                        oBase: 0,
                        oSpeed: Math.random() * 0.003 + 0.001,
                        phase: Math.random() * Math.PI * 2,
                        c: c
                    };
                });
                particles.forEach(p => p.oBase = p.o);
                let time = 0;
                const draw = () => {
                    time++;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    particles.forEach(p => {
                        p.x += p.dx; p.y += p.dy;
                        if (p.x < -10) p.x = canvas.width + 10;
                        if (p.x > canvas.width + 10) p.x = -10;
                        if (p.y < -10) p.y = canvas.height + 10;
                        if (p.y > canvas.height + 10) p.y = -10;
                        p.o = p.oBase + Math.sin(time * p.oSpeed * 2 + p.phase) * 0.08;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(${p.c[0]},${p.c[1]},${p.c[2]},${Math.max(0.02, p.o)})`;
                        ctx.fill();
                        if (p.r > 1.5) {
                            ctx.beginPath();
                            ctx.arc(p.x, p.y, p.r * 3, 0, Math.PI * 2);
                            ctx.fillStyle = `rgba(${p.c[0]},${p.c[1]},${p.c[2]},${p.o * 0.08})`;
                            ctx.fill();
                        }
                    });
                    for (let i = 0; i < particles.length; i++) {
                        for (let j = i + 1; j < particles.length; j++) {
                            const dx = particles[i].x - particles[j].x;
                            const dy = particles[i].y - particles[j].y;
                            const dist = Math.sqrt(dx * dx + dy * dy);
                            if (dist < 130) {
                                ctx.beginPath();
                                ctx.moveTo(particles[i].x, particles[i].y);
                                ctx.lineTo(particles[j].x, particles[j].y);
                                ctx.strokeStyle = `rgba(142,169,154,${0.04 * (1 - dist / 130)})`;
                                ctx.lineWidth = 0.5;
                                ctx.stroke();
                            }
                        }
                    }
                    animId = requestAnimationFrame(draw);
                };
                draw();
                return () => { cancelAnimationFrame(animId); window.removeEventListener('resize', resize); };
            }, []);
            return React.createElement('canvas', { ref: canvasRef, className: 'particles-canvas' });
        }

        // EcoLoop лого SVG (лист с петлёй)
        function LogoIcon({ size = 20, color = 'white' }) {
            return React.createElement('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: color, strokeWidth: '2', strokeLinecap: 'round', strokeLinejoin: 'round' },
                React.createElement('path', { d: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10' }),
                React.createElement('path', { d: 'M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2' }),
                React.createElement('path', { d: 'M8 12c0-2.21 1.79-4 4-4' }),
                React.createElement('path', { d: 'M16 12c0 2.21-1.79 4-4 4' })
            );
        }

        // Модалка Пользовательского соглашения
        function TermsModal({ onAccept, onClose }) {
            const [scrolledToEnd, setScrolledToEnd] = useState(false);
            const [accepted, setAccepted] = useState(false);
            const scrollRef = useRef(null);

            const handleScroll = () => {
                const el = scrollRef.current;
                if (el && el.scrollTop + el.clientHeight >= el.scrollHeight - 20) {
                    setScrolledToEnd(true);
                }
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <div className="p-6 border-b border-white/10">
                            <h2 className="text-xl font-bold text-white">Пользовательское соглашение</h2>
                            <p className="text-sm text-gray-500 mt-1">Прокрутите до конца, чтобы принять</p>
                        </div>
                        <div className="modal-scroll" ref={scrollRef} onScroll={handleScroll}>
                            <div className="text-sm text-gray-300 space-y-4 leading-relaxed">
                                <h3 className="text-white font-bold text-base">1. Статус Платформы</h3>
                                <p>EcoLoop (далее — Платформа) является исключительно информационным посредником (маркетплейсом). Мы предоставляем технологическую площадку для взаимодействия между Поставщиками (Отелями) и Покупателями (Пользователями/Фермерами). Платформа не является производителем, продавцом или владельцем товаров (еды, текстиля, вторсырья).</p>

                                <h3 className="text-white font-bold text-base">2. Отказ от обязательств (Disclaimer)</h3>
                                <p><strong className="text-white">Качество товаров:</strong> Ответственность за свежесть, качество, состав и соблюдение санитарных норм (СанПиН РК) пищевых продуктов несет исключительно Отель, выставивший лот. Платформа не проводит проверку каждой порции еды.</p>
                                <p><strong className="text-white">Здоровье и аллергии:</strong> Пользователь обязан самостоятельно проверять состав продуктов при получении. Платформа не несет ответственности за аллергические реакции или любые последствия для здоровья.</p>
                                <p><strong className="text-white">Финансовые риски:</strong> Платформа не несет ответственности за убытки, возникшие в результате сбоев банковских систем, интернета или действий третьих лиц.</p>

                                <h3 className="text-white font-bold text-base">3. Ограничение ответственности</h3>
                                <p>В максимально допустимой законом степени (согласно законодательству РК), EcoLoop, его основатели и сотрудники не несут ответственности за:</p>
                                <ul className="list-disc pl-5 space-y-1">
                                    <li>Любой прямой или косвенный ущерб, возникший в результате использования Платформы.</li>
                                    <li>Несоответствие информации о лоте (вес, состав), предоставленной Отелем, реальному товару.</li>
                                    <li>Невозможность Отеля выдать оплаченный товар (в этом случае Платформа обязуется вернуть средства на баланс пользователя).</li>
                                </ul>

                                <h3 className="text-white font-bold text-base">4. Обязанности сторон</h3>
                                <p><strong className="text-white">Отель</strong> обязуется выставлять только безопасные для потребления продукты в рамках установленного срока годности.</p>
                                <p><strong className="text-white">Пользователь</strong> обязуется забирать товар в строго установленный временной интервал (тайм-слот). При опоздании товар может быть утилизирован без возврата средств.</p>

                                <h3 className="text-white font-bold text-base">5. Возврат средств</h3>
                                <p>Если продукция оказалась ненадлежащего качества, Пользователь вправе подать жалобу через Платформу в течение 24 часов после получения. Платформа рассмотрит обращение и при подтверждении нарушения вернёт средства на внутренний баланс. Претензии по качеству предъявляются напрямую Администрации Отеля.</p>

                                <h3 className="text-white font-bold text-base">6. Согласие с условиями</h3>
                                <p>Нажимая кнопку «Принять», вы подтверждаете, что:</p>
                                <ul className="list-disc pl-5 space-y-1">
                                    <li>Вам исполнилось 14 лет (или вы имеете согласие родителей).</li>
                                    <li>Вы понимаете, что все претензии по качеству еды предъявляются напрямую Администрации Отеля, указанного в чеке.</li>
                                    <li>Вы согласны с обработкой персональных данных в соответствии с Законом РК «О персональных данных».</li>
                                </ul>

                                <div className="mt-6 p-4 rounded-xl border border-white/10" style={{background: 'rgba(142,169,154,0.08)'}}>
                                    <p className="text-xs text-gray-400">Данное соглашение является публичной офертой в соответствии со ст. 395 Гражданского кодекса Республики Казахстан. Последнее обновление: февраль 2026 г.</p>
                                </div>
                            </div>
                        </div>
                        <div className="p-6 border-t border-white/10">
                            <label className={`flex items-start gap-3 mb-4 cursor-pointer ${!scrolledToEnd ? 'opacity-40 pointer-events-none' : ''}`}>
                                <input type="checkbox" checked={accepted} onChange={(e) => setAccepted(e.target.checked)} className="mt-1 w-4 h-4 accent-emerald-500" />
                                <span className="text-sm text-gray-300">Я принимаю условия Пользовательского соглашения и Политику отказа от ответственности</span>
                            </label>
                            <button
                                onClick={onAccept}
                                disabled={!accepted}
                                className={`w-full py-3 rounded-xl font-bold text-sm transition-all ${accepted ? 'btn-gradient text-gray-900' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}
                            >
                                Принять и продолжить
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Список городов Казахстана
        const KZ_CITIES = [
            'Алматы','Астана','Шымкент','Актобе','Караганда','Тараз','Павлодар',
            'Усть-Каменогорск','Семей','Атырау','Костанай','Кызылорда',
            'Орал (Уральск)','Петропавловск','Актау','Темиртау','Туркестан',
            'Талдыкорган','Экибастуз','Рудный','Жезказган','Кокшетау',
            'Сатпаев','Каскелен','Степногорск','Балхаш','Кентау',
            'Жанаозен','Капчагай','Сарань','Шахтинск','Зыряновск (Алтай)',
            'Байконур','Лисаковск','Хромтау','Аркалык','Кулсары'
        ];

        // Регистрация покупателя
        function BuyerRegister({ navigate }) {
            const [form, setForm] = useState({ surname: '', name: '', patronymic: '', phone: '', email: '', city: '' });
            const [showTerms, setShowTerms] = useState(false);
            const [termsAccepted, setTermsAccepted] = useState(false);
            const [registered, setRegistered] = useState(false);
            const [toast, setToast] = useState(null);

            const isValid = termsAccepted && form.surname && form.name && form.phone && form.email && form.city;

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!termsAccepted) { setShowTerms(true); return; }
                setRegistered(true);
                setToast('Регистрация успешна!');
            };

            const inputCls = "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition";

            if (registered) {
                return (
                    <div className="min-h-screen relative overflow-hidden flex items-center justify-center">
                        <ParticlesBackground />
                        {toast && <Toast message={toast} onClose={() => setToast(null)} />}
                        <div className="relative z-10 max-w-md mx-auto px-4 text-center">
                            <div className="p-10 rounded-2xl border border-white/10" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6" style={{background: 'rgba(142,169,154,0.15)'}}>
                                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>
                                </div>
                                <h2 className="text-2xl font-bold text-white mb-3">Регистрация успешна!</h2>
                                <p className="text-gray-400 text-sm mb-8">Добро пожаловать, {form.name}! Теперь вы можете покупать лоты.</p>
                                <button onClick={(e) => { addRipple(e); navigate('marketplace'); }} className="btn-gradient ripple-effect text-gray-900 px-8 py-3 rounded-xl font-bold text-sm w-full">Открыть маркетплейс</button>
                                <button onClick={() => navigate('landing')} className="mt-3 block mx-auto text-sm text-gray-500 hover:text-gray-300 transition">На главную</button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    {toast && <Toast message={toast} onClose={() => setToast(null)} />}
                    <div className="relative z-10 max-w-lg mx-auto px-4 py-14">
                        <div className="text-center mb-8">
                            <button onClick={() => navigate('landing')} className="text-sm text-gray-500 hover:text-gray-300 transition mb-6 inline-block">← На главную</button>
                            <h1 className="text-3xl font-black text-white mb-2">Регистрация покупателя</h1>
                            <p className="text-gray-500 text-sm">Получите доступ к маркетплейсу со скидками до 70%</p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-4 p-8 rounded-2xl border border-white/10" style={{background: 'rgba(255,255,255,0.02)'}}>
                            <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
                                <div>
                                    <label className="block text-sm font-medium text-gray-300 mb-1.5">Фамилия *</label>
                                    <input type="text" required value={form.surname} onChange={(e) => setForm({...form, surname: e.target.value})} placeholder="Иванов" className={inputCls} />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-300 mb-1.5">Имя *</label>
                                    <input type="text" required value={form.name} onChange={(e) => setForm({...form, name: e.target.value})} placeholder="Иван" className={inputCls} />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-300 mb-1.5">Отчество</label>
                                    <input type="text" value={form.patronymic} onChange={(e) => setForm({...form, patronymic: e.target.value})} placeholder="Иванович" className={inputCls} />
                                </div>
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-300 mb-1.5">Телефон *</label>
                                <input type="tel" required value={form.phone} onChange={(e) => setForm({...form, phone: e.target.value})} placeholder="+7 (777) 123-45-67" className={inputCls} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-300 mb-1.5">Email *</label>
                                <input type="email" required value={form.email} onChange={(e) => setForm({...form, email: e.target.value})} placeholder="ivan@mail.com" className={inputCls} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-300 mb-1.5">Город *</label>
                                <select required value={form.city} onChange={(e) => setForm({...form, city: e.target.value})} className={inputCls} style={{background: '#141414'}}>
                                    <option value="">Выберите город</option>
                                    {KZ_CITIES.map(c => <option key={c} value={c}>{c}</option>)}
                                </select>
                            </div>

                            <div className="pt-2">
                                <label className="flex items-start gap-3 cursor-pointer">
                                    <input type="checkbox" checked={termsAccepted} onChange={() => { if (!termsAccepted) setShowTerms(true); else setTermsAccepted(false); }} className="mt-1 w-4 h-4 accent-emerald-500" />
                                    <span className="text-xs text-gray-400">Я принимаю <button type="button" onClick={() => setShowTerms(true)} className="text-emerald-400 underline">Пользовательское соглашение</button> и Политику отказа от ответственности</span>
                                </label>
                            </div>

                            <button type="submit" onClick={(e) => isValid && addRipple(e)} disabled={!isValid} className={`w-full py-3.5 rounded-xl font-bold text-sm transition-all ripple-effect ${isValid ? 'btn-gradient text-gray-900' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}>
                                Зарегистрироваться
                            </button>
                        </form>
                    </div>

                    {showTerms && <TermsModal onAccept={() => { setTermsAccepted(true); setShowTerms(false); }} onClose={() => setShowTerms(false)} />}
                </div>
            );
        }

        // Выбор роли
        function RoleSelect({ selectRole, navigate }) {
            const [selected, setSelected] = useState(null);

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />

                    <div className="relative z-10 max-w-6xl mx-auto px-4 py-16">
                        <button onClick={() => navigate('landing')} className="text-sm text-gray-500 hover:text-gray-300 transition mb-8 inline-block">← На главную</button>

                        <div className="text-center mb-16 fade-in">
                            <h1 className="text-4xl font-bold mb-4 text-white">
                                Добро пожаловать в <span className="gradient-text">EcoLoop</span>
                            </h1>
                            <p className="text-lg text-gray-400">
                                Выберите, как вы хотите использовать платформу
                            </p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                            <button
                                onClick={() => setSelected('buyer')}
                                className={`p-8 rounded-2xl border text-left transition-all duration-300 ${selected === 'buyer' ? 'border-emerald-500/40 bg-emerald-500/5' : 'border-white/8 hover:border-white/20'}`}
                                style={{background: selected === 'buyer' ? undefined : 'rgba(255,255,255,0.02)'}}
                            >
                                <div className="w-14 h-14 rounded-xl flex items-center justify-center mb-5" style={{background: 'rgba(91,130,145,0.12)'}}>
                                    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#5B8291" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                                </div>
                                <h3 className="text-xl font-bold mb-2 text-white">Я покупатель</h3>
                                <p className="text-gray-400 text-sm mb-4 leading-relaxed">Покупайте качественную еду со скидкой до 70%</p>
                                <div className="space-y-1.5 text-xs text-gray-500">
                                    <div className="flex items-center gap-2"><span className="text-emerald-400">✓</span> Доступ к маркетплейсу</div>
                                    <div className="flex items-center gap-2"><span className="text-emerald-400">✓</span> Скидки до 70%</div>
                                    <div className="flex items-center gap-2"><span className="text-emerald-400">✓</span> Быстрая регистрация</div>
                                </div>
                            </button>

                            <button
                                onClick={() => setSelected('hotel')}
                                className={`p-8 rounded-2xl border text-left transition-all duration-300 ${selected === 'hotel' ? 'border-emerald-500/40 bg-emerald-500/5' : 'border-white/8 hover:border-white/20'}`}
                                style={{background: selected === 'hotel' ? undefined : 'rgba(255,255,255,0.02)'}}
                            >
                                <div className="w-14 h-14 rounded-xl flex items-center justify-center mb-5" style={{background: 'rgba(142,169,154,0.12)'}}>
                                    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"><path d="M3 21h18"/><path d="M5 21V7l8-4v18"/><path d="M19 21V11l-6-4"/><path d="M9 9h1"/><path d="M9 13h1"/><path d="M9 17h1"/></svg>
                                </div>
                                <h3 className="text-xl font-bold mb-2 text-white">Я представитель отеля</h3>
                                <p className="text-gray-400 text-sm mb-4 leading-relaxed">Монетизируйте отходы, получайте ESG-отчёты</p>
                                <div className="space-y-1.5 text-xs text-gray-500">
                                    <div className="flex items-center gap-2"><span className="text-emerald-400">✓</span> Дополнительная выручка</div>
                                    <div className="flex items-center gap-2"><span className="text-emerald-400">✓</span> ESG-отчётность</div>
                                    <div className="flex items-center gap-2"><span className="text-emerald-400">✓</span> Проверка документов</div>
                                </div>
                            </button>
                        </div>

                        {selected && (
                            <div className="text-center mt-10 fade-in">
                                <button
                                    onClick={() => selectRole(selected)}
                                    className="btn-gradient text-gray-900 px-10 py-3.5 rounded-xl font-bold text-sm"
                                >
                                    Продолжить
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Форма заявки для отеля
        function HotelRequestForm({ navigate }) {
            const [formData, setFormData] = useState({
                hotelName: '',
                contactName: '',
                position: '',
                email: '',
                phone: '',
                bin: ''
            });
            const [submitted, setSubmitted] = useState(false);
            const [emailError, setEmailError] = useState('');
            const [termsAccepted, setTermsAccepted] = useState(false);
            const [showTerms, setShowTerms] = useState(false);

            const validateEmail = (email) => {
                const publicDomains = ['gmail.com', 'mail.ru', 'yandex.ru', 'inbox.ru'];
                const domain = email.split('@')[1];
                if (publicDomains.includes(domain)) {
                    setEmailError('Используйте корпоративный email отеля');
                    return false;
                }
                setEmailError('');
                return true;
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!validateEmail(formData.email)) return;
                if (!termsAccepted) return;
                sendToTelegram('hotel', formData);
                setSubmitted(true);
            };

            if (submitted) {
                return (
                    <div className="min-h-screen relative overflow-hidden flex items-center justify-center">
                        <ParticlesBackground />
                        <div className="relative z-10 max-w-md mx-auto px-4 text-center">
                            <div className="p-10 rounded-2xl border border-white/10" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6" style={{background: 'rgba(142,169,154,0.15)'}}>
                                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>
                                </div>
                                <h2 className="text-2xl font-bold mb-3 text-white">Заявка отправлена!</h2>
                                <p className="text-gray-400 text-sm mb-6 leading-relaxed">
                                    Наш менеджер свяжется с вами в течение 24 часов.
                                </p>
                                <div className="rounded-xl p-5 mb-6 text-left border border-white/10" style={{background: 'rgba(142,169,154,0.06)'}}>
                                    <h3 className="font-bold mb-3 text-sm text-emerald-400">Следующие шаги:</h3>
                                    <ol className="space-y-2 text-sm text-gray-400">
                                        <li>1. Проверка БИН в базе КГД</li>
                                        <li>2. Запрос документов</li>
                                        <li>3. Подписание договора через ЭЦП</li>
                                        <li>4. Личный онбординг</li>
                                    </ol>
                                </div>
                                <button onClick={() => navigate('landing')} className="text-sm text-gray-500 hover:text-gray-300 transition">
                                    На главную
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />

                    <div className="relative z-10 max-w-3xl mx-auto px-4 py-12">
                        <button onClick={() => navigate('landing')} className="text-sm text-gray-500 hover:text-gray-300 transition mb-6 inline-block">← На главную</button>
                        <div className="text-center mb-10 fade-in">
                            <h1 className="text-3xl font-bold mb-3 text-white">
                                Подключить отель к <span className="gradient-text">EcoLoop</span>
                            </h1>
                            <p className="text-gray-400 text-sm">
                                Заполните заявку, и мы свяжемся с вами
                            </p>
                        </div>

                        <form onSubmit={handleSubmit} className="p-8 rounded-2xl border border-white/10" style={{background: 'rgba(255,255,255,0.02)'}}>
                            <div className="space-y-6">
                                <div>
                                    <label className="block text-sm font-medium text-gray-300 mb-1.5">Название отеля *</label>
                                    <input type="text" required value={formData.hotelName} onChange={(e) => setFormData({...formData, hotelName: e.target.value})} placeholder="Rixos Almaty" className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Ваше имя *</label>
                                        <input type="text" required value={formData.contactName} onChange={(e) => setFormData({...formData, contactName: e.target.value})} placeholder="Иван Иванов" className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Должность *</label>
                                        <select required value={formData.position} onChange={(e) => setFormData({...formData, position: e.target.value, customPosition: ''})} className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-emerald-500/50 transition" style={{background: '#141414'}}>
                                            <option value="">Выберите</option>
                                            <option value="manager">Управляющий</option>
                                            <option value="chef">Шеф-повар</option>
                                            <option value="director">Директор</option>
                                            <option value="procurement">Закупщик</option>
                                            <option value="owner">Владелец</option>
                                            <option value="other">Другое</option>
                                        </select>
                                        {formData.position === 'other' && (
                                            <input type="text" required value={formData.customPosition || ''} onChange={(e) => setFormData({...formData, customPosition: e.target.value})} placeholder="Укажите вашу должность" className="w-full mt-2 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                        )}
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-300 mb-1.5">Корпоративный email *</label>
                                    <input
                                        type="email"
                                        required
                                        value={formData.email}
                                        onChange={(e) => {
                                            setFormData({...formData, email: e.target.value});
                                            if (e.target.value.includes('@')) {
                                                validateEmail(e.target.value);
                                            }
                                        }}
                                        placeholder="m.ivanov@hilton.com"
                                        className={`w-full px-4 py-3 bg-white/5 border rounded-xl text-white placeholder-gray-600 focus:outline-none transition ${
                                            emailError ? 'border-red-500' : 'border-white/10'
                                        }`}
                                    />
                                    {emailError && (
                                        <p className="text-red-500 text-sm mt-2">⚠ {emailError}</p>
                                    )}
                                    <p className="text-gray-600 text-xs mt-1.5">Не принимаем gmail.com, mail.ru и другие публичные домены</p>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Телефон *</label>
                                        <input type="tel" required value={formData.phone} onChange={(e) => setFormData({...formData, phone: e.target.value})} placeholder="+7 (777) 123-45-67" className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">БИН (опционально)</label>
                                        <input type="text" value={formData.bin} onChange={(e) => setFormData({...formData, bin: e.target.value})} placeholder="123456789012" maxLength="12" className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                        <p className="text-gray-600 text-xs mt-1.5">Для ускорения проверки</p>
                                    </div>
                                </div>

                                <div className="rounded-xl p-4 border border-white/10" style={{background: 'rgba(91,130,145,0.06)'}}>
                                    <h4 className="font-medium mb-2 text-sm text-gray-300">Что будет дальше:</h4>
                                    <ul className="text-sm text-gray-500 space-y-1">
                                        <li>• Проверка БИН в базе КГД (kgd.gov.kz)</li>
                                        <li>• Запрос справки о регистрации юрлица</li>
                                        <li>• Подписание договора через ЭЦП</li>
                                        <li>• Личный визит для онбординга</li>
                                    </ul>
                                </div>

                                {/* Принятие политики */}
                                <div className="flex items-start gap-3">
                                    <input type="checkbox" id="hotel-terms" checked={termsAccepted} onChange={(e) => setTermsAccepted(e.target.checked)} className="mt-1 w-4 h-4 rounded accent-emerald-500 cursor-pointer" />
                                    <label htmlFor="hotel-terms" className="text-sm text-gray-400 leading-relaxed cursor-pointer">
                                        Я ознакомлен(а) и принимаю{' '}
                                        <button type="button" onClick={() => setShowTerms(true)} className="text-emerald-400 underline hover:text-emerald-300 transition">Условия использования</button>{' '}
                                        и{' '}
                                        <button type="button" onClick={() => setShowTerms(true)} className="text-emerald-400 underline hover:text-emerald-300 transition">Политику конфиденциальности</button>,{' '}
                                        а также даю согласие на обработку персональных данных.
                                    </label>
                                </div>

                                <button type="submit" disabled={!termsAccepted} className={`w-full px-8 py-3.5 rounded-xl font-bold text-sm transition-all ${termsAccepted ? 'btn-gradient text-gray-900' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}>
                                    Отправить заявку
                                </button>

                                {/* Модалка с условиями */}
                                {showTerms && (
                                    <div className="modal-overlay" onClick={() => setShowTerms(false)}>
                                        <div className="relative z-10 max-w-2xl mx-auto mx-4" onClick={(e) => e.stopPropagation()}>
                                            <div className="rounded-2xl border border-white/10 p-8 max-h-[80vh] overflow-y-auto" style={{background: '#141414'}}>
                                                <div className="flex justify-between items-center mb-6">
                                                    <h3 className="text-xl font-bold text-white">Условия использования и Политика конфиденциальности</h3>
                                                    <button onClick={() => setShowTerms(false)} className="text-gray-500 hover:text-white transition">
                                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                                    </button>
                                                </div>
                                                <div className="space-y-4 text-sm text-gray-400 leading-relaxed">
                                                    <h4 className="text-white font-semibold text-base">1. Общие положения</h4>
                                                    <p>Платформа EcoLoop (далее — «Платформа») предоставляет услуги маркетплейса для перераспределения излишков продуктов, текстиля и вторсырья от гостиниц и ресторанов (далее — «Продавцы») покупателям (далее — «Покупатели»). Настоящие Условия регулируют отношения между Платформой и Продавцом.</p>
                                                    <h4 className="text-white font-semibold text-base">2. Регистрация и верификация</h4>
                                                    <p>Для регистрации на Платформе Продавец обязан предоставить достоверные сведения: наименование юридического лица, БИН, контактные данные ответственного лица, корпоративный email. Платформа оставляет за собой право запросить дополнительные документы для верификации.</p>
                                                    <h4 className="text-white font-semibold text-base">3. Обязательства Продавца</h4>
                                                    <p>Продавец гарантирует качество и безопасность размещаемых лотов. Продукты питания должны соответствовать санитарным нормам РК. Продавец обязуется обеспечить своевременный самовывоз лотов покупателями в указанное время.</p>
                                                    <h4 className="text-white font-semibold text-base">4. Оплата и комиссия</h4>
                                                    <p>Платформа взимает сервисный сбор в размере 10% от стоимости каждой сделки. Выплаты Продавцу производятся еженедельно на указанный банковский счёт. Возвраты обрабатываются в течение 3 рабочих дней.</p>
                                                    <h4 className="text-white font-semibold text-base">5. Политика конфиденциальности</h4>
                                                    <p>Платформа собирает и обрабатывает персональные данные в соответствии с Законом РК «О персональных данных и их защите». Данные используются исключительно для предоставления услуг Платформы и не передаются третьим лицам без согласия пользователя, за исключением случаев, предусмотренных законодательством.</p>
                                                    <h4 className="text-white font-semibold text-base">6. Ответственность</h4>
                                                    <p>Платформа не несёт ответственности за качество лотов, размещённых Продавцами. Споры между Продавцом и Покупателем решаются через систему жалоб Платформы. При систематических нарушениях аккаунт может быть заблокирован.</p>
                                                    <h4 className="text-white font-semibold text-base">7. Заключительные положения</h4>
                                                    <p>Платформа оставляет за собой право изменять настоящие Условия с уведомлением пользователей за 14 дней. Продолжение использования Платформы после изменения Условий означает согласие с ними.</p>
                                                </div>
                                                <button onClick={() => { setTermsAccepted(true); setShowTerms(false); }} className="w-full mt-6 btn-gradient text-gray-900 px-8 py-3 rounded-xl font-bold text-sm">
                                                    Принимаю условия
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // Главная страница
        function Landing({ navigate }) {
            const [mobileMenu, setMobileMenu] = useState(false);
            const [openFaq, setOpenFaq] = useState(null);
            const [callbackPhone, setCallbackPhone] = useState('');
            const [callbackName, setCallbackName] = useState('');
            const [callbackSent, setCallbackSent] = useState(false);
            const [toastMsg, setToastMsg] = useState(null);
            const headerRef = useRef(null);

            useEffect(() => {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('visible');
                    });
                }, { threshold: 0.15 });
                document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

                const onScroll = () => {
                    if (headerRef.current) {
                        headerRef.current.classList.toggle('scrolled', window.scrollY > 50);
                    }
                };
                window.addEventListener('scroll', onScroll);
                return () => { observer.disconnect(); window.removeEventListener('scroll', onScroll); };
            }, []);

            const faqs = [
                { q: 'Какие отели могут подключиться?', a: 'Любой отель, ресторан или хостел с БИН и корпоративным email. Мы проверим документы через базы КГД.' },
                { q: 'Какова комиссия платформы?', a: 'Комиссия составляет 6% от каждой сделки. Подключение бесплатное, абонентской платы нет.' },
                { q: 'Безопасно ли покупать еду?', a: 'Каждый отель проходит верификацию. Продукты выставляются строго в рамках срока годности. Есть возврат средств в течение 24ч.' },
                { q: 'Как быстро приходят выплаты?', a: 'Выплаты производятся еженедельно на расчётный счёт отеля. Деньги удерживаются на escrow до подтверждения приёмки.' },
            ];

            const navLinks = [
                { href: '#about', label: 'О проекте' },
                { href: '#what-we-do', label: 'Что мы делаем' },
                { href: '#how-it-works', label: 'Как работает' },
                { href: '#goals', label: 'Цели' },
                { href: '#faq', label: 'FAQ' },
            ];

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    <ScrollToTop />
                    {toastMsg && <Toast message={toastMsg} onClose={() => setToastMsg(null)} />}

                    {/* Sticky шапка */}
                    <header ref={headerRef} className="header-sticky border-b border-white/5" style={{background: 'rgba(10,10,10,0.6)', backdropFilter: 'blur(12px)'}}>
                        <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center space-x-3">
                                <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}>
                                    <LogoIcon size={20} color="white" />
                                </div>
                                <span className="text-xl font-extrabold text-white tracking-tight">EcoLoop</span>
                            </div>
                            <nav className="hidden md:flex items-center gap-6">
                                {navLinks.map(l => (
                                    <a key={l.href} href={l.href} className="text-gray-400 hover:text-white transition-all duration-300 text-sm font-medium nav-link">{l.label}</a>
                                ))}
                                <button onClick={(e) => { addRipple(e); navigate('role-select'); }} className="btn-outline ripple-effect px-5 py-2 rounded-lg font-medium text-sm">
                                    Войти
                                </button>
                            </nav>
                            {/* Мобильный бургер */}
                            <button className="md:hidden text-gray-400 hover:text-white transition" onClick={() => setMobileMenu(!mobileMenu)}>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
                            </button>
                        </div>
                    </header>

                    {/* Мобильное меню */}
                    {mobileMenu && (
                        <div className="mobile-menu">
                            <button className="absolute top-6 right-6 text-gray-400 hover:text-white" onClick={() => setMobileMenu(false)}>
                                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                            </button>
                            {navLinks.map(l => (
                                <a key={l.href} href={l.href} onClick={() => setMobileMenu(false)} className="text-2xl font-bold text-white hover:text-emerald-400 transition">{l.label}</a>
                            ))}
                            <button onClick={() => { setMobileMenu(false); navigate('role-select'); }} className="btn-gradient text-gray-900 px-10 py-3 rounded-xl font-bold text-base">Войти</button>
                        </div>
                    )}

                    {/* Hero */}
                    <section className="relative z-10 max-w-6xl mx-auto px-4 pt-28 pb-20 text-center">
                        <div className="fade-in">
                            <div className="inline-flex items-center gap-2 mb-8 px-4 py-2 rounded-full border border-white/10" style={{background: 'rgba(142,169,154,0.08)'}}>
                                <div className="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></div>
                                <span className="text-gray-300 text-sm font-medium">B2B Circular Economy Platform</span>
                            </div>
                            <h1 className="text-5xl md:text-7xl font-black mb-8 leading-[1.08] tracking-tight text-white">
                                Превращаем отходы отелей<br />
                                <span className="hero-accent">в доход и репутацию</span>
                            </h1>
                            <p className="text-lg md:text-xl text-gray-400 mb-12 max-w-3xl mx-auto leading-relaxed">
                                Первая цифровая платформа для монетизации органических отходов гостиничного бизнеса Казахстана. Юридическая безопасность, ESG-аналитика и прозрачные финансы.
                            </p>
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                <button onClick={(e) => { addRipple(e); navigate('role-select'); }} className="btn-gradient ripple-effect text-gray-900 px-10 py-4 rounded-xl font-bold text-base">
                                    Подключить отель
                                </button>
                                <button onClick={(e) => { addRipple(e); navigate('buyer-register'); }} className="btn-outline ripple-effect px-10 py-4 rounded-xl font-bold text-base">
                                    Зарегистрироваться как покупатель
                                </button>
                            </div>
                        </div>
                    </section>

                    {/* Метрики */}
                    <section className="relative z-10 max-w-5xl mx-auto px-4 py-16">
                        <div className="grid grid-cols-3 gap-6 reveal">
                            <div className="text-center p-8 rounded-2xl border border-white/5" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="text-4xl md:text-5xl font-black text-white mb-2 counter-value">50K+</div>
                                <div className="text-sm text-gray-500 font-medium">кг еды спасено</div>
                            </div>
                            <div className="text-center p-8 rounded-2xl border border-white/5" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="text-4xl md:text-5xl font-black text-white mb-2 counter-value">100+</div>
                                <div className="text-sm text-gray-500 font-medium">отелей подключено</div>
                            </div>
                            <div className="text-center p-8 rounded-2xl border border-white/5" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="text-4xl md:text-5xl font-black text-white mb-2 counter-value">140т</div>
                                <div className="text-sm text-gray-500 font-medium">CO₂ предотвращено</div>
                            </div>
                        </div>
                    </section>

                    {/* Нам доверяют */}
                    <section className="relative z-10 max-w-5xl mx-auto px-4 py-12">
                        <div className="text-center mb-8 reveal">
                            <div className="text-xs text-gray-600 uppercase tracking-widest mb-6">Нам доверяют</div>
                            <div className="flex flex-wrap justify-center gap-4">
                                {['Rixos Hotels','Hilton','Marriott','Ritz-Carlton','Holiday Inn','Novotel'].map(p => (
                                    <div key={p} className="partner-badge">{p}</div>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* О проекте */}
                    <section id="about" className="relative z-10 max-w-6xl mx-auto px-4 py-24">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                            <div className="reveal">
                                <div className="section-label">О проекте</div>
                                <h2 className="text-4xl md:text-5xl font-black text-white mb-6 leading-tight section-title">
                                    Экономика замкнутого цикла для отелей
                                </h2>
                                <p className="text-gray-400 text-lg leading-relaxed mb-6">
                                    Ежегодно отели Казахстана генерируют тысячи тонн пищевых отходов, которые отправляются на свалку. EcoLoop создаёт мост между гостиничным бизнесом и аграрным сектором, превращая отходы в ценный ресурс.
                                </p>
                                <p className="text-gray-400 text-lg leading-relaxed">
                                    Мы соединяем отели с фермерскими хозяйствами и приютами, обеспечивая юридическую чистоту каждой сделки через проверку БИН, договоры с ЭЦП и полное соответствие Экологическому кодексу РК.
                                </p>
                            </div>
                            <div className="reveal reveal-delay-2 grid grid-cols-2 gap-4">
                                <div className="p-6 rounded-2xl border border-white/8" style={{background: 'rgba(142,169,154,0.06)'}}>
                                    <div className="w-10 h-10 rounded-lg flex items-center justify-center mb-4" style={{background: 'rgba(142,169,154,0.15)'}}>
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                                    </div>
                                    <div className="text-white font-bold text-sm mb-1">Верификация БИН</div>
                                    <div className="text-gray-500 text-xs">Через базы КГД МФ РК</div>
                                </div>
                                <div className="p-6 rounded-2xl border border-white/8" style={{background: 'rgba(91,130,145,0.06)'}}>
                                    <div className="w-10 h-10 rounded-lg flex items-center justify-center mb-4" style={{background: 'rgba(91,130,145,0.15)'}}>
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#5B8291" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                                    </div>
                                    <div className="text-white font-bold text-sm mb-1">Договор ЭЦП</div>
                                    <div className="text-gray-500 text-xs">Юридическая сила</div>
                                </div>
                                <div className="p-6 rounded-2xl border border-white/8" style={{background: 'rgba(242,201,76,0.04)'}}>
                                    <div className="w-10 h-10 rounded-lg flex items-center justify-center mb-4" style={{background: 'rgba(242,201,76,0.12)'}}>
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#F2C94C" strokeWidth="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                                    </div>
                                    <div className="text-white font-bold text-sm mb-1">Escrow-платежи</div>
                                    <div className="text-gray-500 text-xs">Безопасные сделки</div>
                                </div>
                                <div className="p-6 rounded-2xl border border-white/8" style={{background: 'rgba(142,169,154,0.06)'}}>
                                    <div className="w-10 h-10 rounded-lg flex items-center justify-center mb-4" style={{background: 'rgba(142,169,154,0.15)'}}>
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                                    </div>
                                    <div className="text-white font-bold text-sm mb-1">ESG-аналитика</div>
                                    <div className="text-gray-500 text-xs">CO₂, вода, отходы</div>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Что мы делаем */}
                    <section id="what-we-do" className="relative z-10 max-w-6xl mx-auto px-4 py-24">
                        <div className="text-center mb-16 reveal">
                            <div className="section-label">Что мы делаем</div>
                            <h2 className="text-4xl md:text-5xl font-black text-white mb-6 tracking-tight section-title">
                                Три направления работы
                            </h2>
                            <p className="text-lg text-gray-400 max-w-2xl mx-auto">
                                Платформа решает проблему на трёх уровнях: юридическом, финансовом и экологическом
                            </p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="reveal reveal-delay-1 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-emerald-500/30" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="w-12 h-12 rounded-xl flex items-center justify-center mb-6" style={{background: 'rgba(142,169,154,0.12)'}}>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><polyline points="9 12 11 14 15 10"/></svg>
                                </div>
                                <h3 className="text-xl font-bold text-white mb-3">Юридическая безопасность</h3>
                                <p className="text-gray-400 leading-relaxed text-sm">
                                    Проверка БИН через государственные базы КГД. Подписание договоров через ЭЦП. Полное соответствие Экологическому кодексу РК ст. 351 и Санитарным правилам 2022 года.
                                </p>
                            </div>

                            <div className="reveal reveal-delay-2 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-blue-500/30" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="w-12 h-12 rounded-xl flex items-center justify-center mb-6" style={{background: 'rgba(91,130,145,0.12)'}}>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#5B8291" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                                </div>
                                <h3 className="text-xl font-bold text-white mb-3">Финансовая прозрачность</h3>
                                <p className="text-gray-400 leading-relaxed text-sm">
                                    Escrow-система гарантирует безопасность каждой сделки. Средства удерживаются до подтверждения приёмки. Еженедельные выплаты на счёт отеля с комиссией 6%.
                                </p>
                            </div>

                            <div className="reveal reveal-delay-3 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-yellow-500/30" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="w-12 h-12 rounded-xl flex items-center justify-center mb-6" style={{background: 'rgba(242,201,76,0.10)'}}>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#F2C94C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                                </div>
                                <h3 className="text-xl font-bold text-white mb-3">ESG-отчётность</h3>
                                <p className="text-gray-400 leading-relaxed text-sm">
                                    Автоматический расчёт предотвращённых выбросов CO₂ по формуле WRAP (2.8 кг CO₂e / кг). Генерация сертификатов для международных отельных сетей и инвесторов.
                                </p>
                            </div>
                        </div>
                    </section>

                    {/* Как это работает */}
                    <section id="how-it-works" className="relative z-10 max-w-5xl mx-auto px-4 py-24">
                        <div className="text-center mb-16 reveal">
                            <div className="section-label">Процесс</div>
                            <h2 className="text-4xl md:text-5xl font-black text-white mb-6 tracking-tight section-title">
                                Как это работает
                            </h2>
                        </div>

                        <div className="space-y-4">
                            <div className="reveal reveal-delay-1 p-8 rounded-2xl border border-white/8 flex items-start gap-6 transition-all duration-500 hover:border-white/15" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center font-black text-lg" style={{background: 'rgba(142,169,154,0.12)', color: '#8EA99A'}}>01</div>
                                <div>
                                    <h3 className="text-xl font-bold text-white mb-2">Регистрация и верификация</h3>
                                    <p className="text-gray-400 text-sm leading-relaxed">
                                        Заполните заявку с корпоративным email и БИН. Мы проверим документы через базу КГД, подпишем договор через ЭЦП и проведём личный онбординг.
                                    </p>
                                </div>
                            </div>

                            <div className="reveal reveal-delay-2 p-8 rounded-2xl border border-white/8 flex items-start gap-6 transition-all duration-500 hover:border-white/15" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center font-black text-lg" style={{background: 'rgba(91,130,145,0.12)', color: '#5B8291'}}>02</div>
                                <div>
                                    <h3 className="text-xl font-bold text-white mb-2">Публикация лотов</h3>
                                    <p className="text-gray-400 text-sm leading-relaxed">
                                        Загружайте фото, укажите категорию отходов, вес, цену и время самовывоза. Лот мгновенно появляется на маркетплейсе для покупателей.
                                    </p>
                                </div>
                            </div>

                            <div className="reveal reveal-delay-3 p-8 rounded-2xl border border-white/8 flex items-start gap-6 transition-all duration-500 hover:border-white/15" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center font-black text-lg" style={{background: 'rgba(242,201,76,0.10)', color: '#F2C94C'}}>03</div>
                                <div>
                                    <h3 className="text-xl font-bold text-white mb-2">Сделка и выплаты</h3>
                                    <p className="text-gray-400 text-sm leading-relaxed">
                                        Покупатель оплачивает через escrow. После подтверждения приёмки деньги поступают на ваш счёт. Еженедельные выплаты, комиссия — 6%.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Наши цели */}
                    <section id="goals" className="relative z-10 max-w-6xl mx-auto px-4 py-24">
                        <div className="text-center mb-16 reveal">
                            <div className="section-label">Амбиции</div>
                            <h2 className="text-4xl md:text-5xl font-black text-white mb-6 tracking-tight section-title">
                                Наши цели
                            </h2>
                            <p className="text-lg text-gray-400 max-w-2xl mx-auto">
                                Строим первую циркулярную экосистему для гостиничного бизнеса Казахстана
                            </p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
                            <div className="reveal reveal-delay-1 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-emerald-500/20" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex items-center gap-4 mb-4">
                                    <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={{background: 'rgba(142,169,154,0.12)'}}>
                                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><path d="M3 21h18"/><path d="M5 21V7l8-4v18"/><path d="M19 21V11l-6-4"/></svg>
                                    </div>
                                    <div>
                                        <div className="text-3xl font-black text-white">500</div>
                                        <div className="text-xs text-gray-500 uppercase tracking-wider">отелей к 2026</div>
                                    </div>
                                </div>
                                <p className="text-gray-400 text-sm leading-relaxed">
                                    Подключить крупные сети: Rixos, Hilton, Marriott, Ritz-Carlton и локальные бренды Казахстана.
                                </p>
                            </div>

                            <div className="reveal reveal-delay-2 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-blue-500/20" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex items-center gap-4 mb-4">
                                    <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={{background: 'rgba(91,130,145,0.12)'}}>
                                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#5B8291" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                                    </div>
                                    <div>
                                        <div className="text-3xl font-black text-white">1 000 т</div>
                                        <div className="text-xs text-gray-500 uppercase tracking-wider">CO₂ предотвращено / год</div>
                                    </div>
                                </div>
                                <p className="text-gray-400 text-sm leading-relaxed">
                                    Сократить углеродный след индустрии через переработку и повторное использование ресурсов.
                                </p>
                            </div>

                            <div className="reveal reveal-delay-3 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-yellow-500/20" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex items-center gap-4 mb-4">
                                    <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={{background: 'rgba(242,201,76,0.10)'}}>
                                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#F2C94C" strokeWidth="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                                    </div>
                                    <div>
                                        <div className="text-3xl font-black text-white">₸50M</div>
                                        <div className="text-xs text-gray-500 uppercase tracking-wider">выручка партнёров</div>
                                    </div>
                                </div>
                                <p className="text-gray-400 text-sm leading-relaxed">
                                    Помочь отелям монетизировать отходы и снизить расходы на утилизацию на 40-60%.
                                </p>
                            </div>

                            <div className="reveal reveal-delay-4 p-8 rounded-2xl border border-white/8 transition-all duration-500 hover:border-emerald-500/20" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="flex items-center gap-4 mb-4">
                                    <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={{background: 'rgba(142,169,154,0.12)'}}>
                                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                                    </div>
                                    <div>
                                        <div className="text-3xl font-black text-white">ESG</div>
                                        <div className="text-xs text-gray-500 uppercase tracking-wider">стандарт индустрии</div>
                                    </div>
                                </div>
                                <p className="text-gray-400 text-sm leading-relaxed">
                                    Стать обязательным инструментом ESG-отчётности для международных отельных сетей в Казахстане.
                                </p>
                            </div>
                        </div>
                    </section>

                    {/* Менеджер свяжется */}
                    <section className="relative z-10 max-w-4xl mx-auto px-4 py-24">
                        <div className="reveal callback-card">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-12 items-center relative z-10">
                                <div>
                                    <div className="section-label">Обратный звонок</div>
                                    <h2 className="text-3xl md:text-4xl font-black text-white mb-4 section-title">Наш менеджер свяжется с вами</h2>
                                    <p className="text-gray-400 leading-relaxed">Оставьте номер телефона — мы перезвоним в течение 30 минут в рабочее время. Ответим на все вопросы о подключении, комиссиях и интеграции.</p>
                                    <div className="mt-6 space-y-2">
                                        <div className="flex items-center gap-3 text-sm text-gray-400"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg> Бесплатная консультация</div>
                                        <div className="flex items-center gap-3 text-sm text-gray-400"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg> Персональный менеджер</div>
                                        <div className="flex items-center gap-3 text-sm text-gray-400"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg> Помощь с онбордингом</div>
                                    </div>
                                </div>
                                <div>
                                    {callbackSent ? (
                                        <div className="text-center p-8 rounded-2xl border border-emerald-500/20" style={{background: 'rgba(142,169,154,0.06)'}}>
                                            <div className="w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-4" style={{background: 'rgba(142,169,154,0.15)'}}>
                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>
                                            </div>
                                            <h3 className="text-xl font-bold text-white mb-2">Заявка принята!</h3>
                                            <p className="text-gray-400 text-sm">Менеджер перезвонит в течение 30 минут</p>
                                        </div>
                                    ) : (
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-300 mb-1.5">Ваше имя</label>
                                                <input type="text" value={callbackName} onChange={(e) => setCallbackName(e.target.value)} placeholder="Иван" className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-300 mb-1.5">Телефон *</label>
                                                <input type="tel" value={callbackPhone} onChange={(e) => setCallbackPhone(e.target.value)} placeholder="+7 (777) 123-45-67" className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition" />
                                            </div>
                                            <button onClick={(e) => { if (!callbackPhone) return; addRipple(e); sendToTelegram('callback', {name: callbackName, phone: callbackPhone}); setCallbackSent(true); setToastMsg('Заявка отправлена! Менеджер свяжется с вами.'); }} disabled={!callbackPhone} className={`w-full py-3.5 rounded-xl font-bold text-sm ripple-effect transition-all ${callbackPhone ? 'btn-gradient text-gray-900' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}>
                                                Перезвоните мне
                                            </button>
                                            <p className="text-xs text-gray-600 text-center">Нажимая кнопку, вы соглашаетесь на обработку персональных данных</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* CTA */}
                    <section className="relative z-10 max-w-4xl mx-auto px-4 py-24">
                        <div className="reveal p-14 rounded-3xl text-center border border-white/10" style={{background: 'linear-gradient(135deg, rgba(142,169,154,0.08), rgba(91,130,145,0.06))'}}>
                            <h2 className="text-4xl md:text-5xl font-black text-white mb-5 tracking-tight section-title">
                                Готовы начать?
                            </h2>
                            <p className="text-lg text-gray-400 mb-10 max-w-2xl mx-auto leading-relaxed">
                                Присоединяйтесь к циркулярной экономике. Экономьте деньги, помогайте экологии, повышайте ESG-рейтинг.
                            </p>
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                <button onClick={(e) => { addRipple(e); navigate('role-select'); }} className="btn-gradient ripple-effect text-gray-900 px-10 py-4 rounded-xl font-bold text-base">
                                    Подключить отель
                                </button>
                                <button onClick={(e) => { addRipple(e); navigate('buyer-register'); }} className="btn-outline ripple-effect px-10 py-4 rounded-xl font-bold text-base">
                                    Зарегистрироваться как покупатель
                                </button>
                            </div>
                            <div className="mt-8 flex flex-wrap justify-center gap-6 text-xs text-gray-500">
                                <span>Бесплатное подключение</span>
                                <span className="text-gray-600">|</span>
                                <span>Комиссия 6%</span>
                                <span className="text-gray-600">|</span>
                                <span>Поддержка 24/7</span>
                                <span className="text-gray-600">|</span>
                                <span>ESG-отчёты</span>
                            </div>
                        </div>
                    </section>

                    {/* FAQ */}
                    <section id="faq" className="relative z-10 max-w-3xl mx-auto px-4 py-24">
                        <div className="text-center mb-12 reveal">
                            <div className="section-label">Частые вопросы</div>
                            <h2 className="text-4xl font-black text-white tracking-tight section-title">FAQ</h2>
                        </div>
                        <div className="space-y-3 reveal reveal-delay-1">
                            {faqs.map((f, i) => (
                                <div key={i} className={`faq-item ${openFaq === i ? 'open' : ''}`}>
                                    <button className="w-full flex justify-between items-center p-5 text-left" onClick={() => setOpenFaq(openFaq === i ? null : i)}>
                                        <span className="text-white font-semibold text-sm pr-4">{f.q}</span>
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="2" style={{transform: openFaq === i ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.3s ease', flexShrink: 0}}>
                                            <polyline points="6 9 12 15 18 9"/>
                                        </svg>
                                    </button>
                                    <div className="faq-answer">
                                        <div className="px-5 pb-5 text-sm text-gray-400 leading-relaxed">{f.a}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </section>

                    {/* Footer */}
                    <footer className="relative z-10 border-t border-white/5">
                        <div className="max-w-7xl mx-auto px-4 py-10">
                            <div className="flex flex-col md:flex-row justify-between items-center gap-4">
                                <div className="flex items-center gap-2">
                                    <div className="w-8 h-8 rounded-lg flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}>
                                        <LogoIcon size={14} color="white" />
                                    </div>
                                    <span className="text-sm font-bold text-white">EcoLoop</span>
                                </div>
                                <div className="text-xs text-gray-600">
                                    2026 EcoLoop. Все права защищены.
                                </div>
                                <div className="flex gap-6 text-xs text-gray-500">
                                    <a href="#" className="hover:text-gray-300 transition-all duration-300">Условия</a>
                                    <a href="#" className="hover:text-gray-300 transition-all duration-300">Политика</a>
                                    <a href="#" className="hover:text-gray-300 transition-all duration-300">Контакты</a>
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        }

        // Таймер обратного отсчёта
        function CountdownTimer({ minutes }) {
            const [timeLeft, setTimeLeft] = useState(minutes * 60);
            useEffect(() => {
                if (timeLeft <= 0) return;
                const t = setInterval(() => setTimeLeft(prev => Math.max(0, prev - 1)), 1000);
                return () => clearInterval(t);
            }, [timeLeft]);
            const h = Math.floor(timeLeft / 3600);
            const m = Math.floor((timeLeft % 3600) / 60);
            const s = timeLeft % 60;
            const pad = (n) => n.toString().padStart(2, '0');
            const isUrgent = timeLeft < 1800;
            return (
                <div className={`flex items-center gap-1.5 text-xs font-mono font-bold ${isUrgent ? 'text-red-400' : 'text-amber-400'}`}>
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    {h > 0 && `${pad(h)}:`}{pad(m)}:{pad(s)}
                </div>
            );
        }

        // Маркетплейс
        function Marketplace({ navigate }) {
            const [searchTerm, setSearchTerm] = useState('');
            
            const listings = [
                {
                    id: 1,
                    title: 'Magic Box от 4★ отеля',
                    category: 'Еда',
                    description: 'Свежая выпечка и кондитерские изделия',
                    price: 500,
                    originalPrice: 1500,
                    quantity: '5 кг',
                    location: 'Центральный район',
                    time: '21:30',
                    discount: 67,
                    minutesLeft: 45
                },
                {
                    id: 2,
                    title: 'Пластиковая тара',
                    category: 'Пластик',
                    description: 'Чистые пластиковые бутылки и контейнеры',
                    price: 200,
                    originalPrice: 600,
                    quantity: '50 кг',
                    location: 'Медеуский район',
                    time: '18:00',
                    discount: 67,
                    minutesLeft: 180
                },
                {
                    id: 3,
                    title: 'Постельное бельё',
                    category: 'Текстиль',
                    description: 'Использованное, но чистое постельное бельё',
                    price: 150,
                    originalPrice: 450,
                    quantity: '20 комплектов',
                    location: 'Алмалинский район',
                    time: '20:00',
                    discount: 67,
                    minutesLeft: 90
                }
            ];

            const filteredListings = listings.filter(listing => 
                listing.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                listing.description.toLowerCase().includes(searchTerm.toLowerCase())
            );

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />

                    {/* Шапка */}
                    <header className="relative z-10 glass-effect border-b border-white/10 sticky top-0 fade-in">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex justify-between items-center mb-4">
                                <button onClick={() => navigate('landing')} className="flex items-center space-x-3">
                                    <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}>
                                        <LogoIcon size={20} color="white" />
                                    </div>
                                    <span className="text-xl font-bold text-white">EcoLoop</span>
                                </button>
                                <div className="flex items-center gap-4">
                                    <button onClick={() => navigate('buyer-profile')} className="text-gray-400 hover:text-white text-sm nav-link transition">Профиль</button>
                                    <button onClick={() => navigate('dashboard')} className="text-gray-400 hover:text-white text-sm nav-link transition">Кабинет</button>
                                    <button onClick={() => navigate('landing')} className="text-gray-500 hover:text-gray-300 text-sm transition">Главная</button>
                                </div>
                            </div>
                            
                            {/* Поиск */}
                            <div className="relative">
                                <input
                                    type="text"
                                    placeholder="Поиск еды, вторсырья, текстиля..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-emerald-500"
                                />
                            </div>
                        </div>
                    </header>

                    {/* Лоты */}
                    <div className="relative z-10 max-w-7xl mx-auto px-4 py-8">
                        <h1 className="text-4xl font-bold gradient-text mb-8">Доступные лоты</h1>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                            {filteredListings.map((listing, index) => (
                                <button key={listing.id} onClick={() => navigate('lot-detail', listing)} className="block text-left">
                                    <div className="mirror-card overflow-hidden fade-in hover-glow" style={{animationDelay: `${index * 0.1}s`}}>
                                        <div className="h-56 bg-gradient-to-br from-emerald-500/20 via-teal-500/20 to-cyan-500/20 flex items-center justify-center relative">
                                            <div className="text-6xl float-element">
                                                {listing.category === 'Еда' ? '🍽️' : listing.category === 'Пластик' ? '♻️' : '👕'}
                                            </div>
                                            {listing.discount && (
                                                <div className="absolute top-4 right-4 bg-gradient-to-r from-red-500 to-pink-500 text-white px-3 py-2 rounded-xl text-sm font-bold shadow-lg">
                                                    -{listing.discount}%
                                                </div>
                                            )}
                                            {listing.minutesLeft && (
                                                <div className="absolute top-4 left-4 px-3 py-1.5 rounded-lg" style={{background: 'rgba(0,0,0,0.6)', backdropFilter: 'blur(8px)'}}>
                                                    <CountdownTimer minutes={listing.minutesLeft} />
                                                </div>
                                            )}
                                        </div>
                                        <div className="p-6">
                                            <div className="flex justify-between items-start mb-4">
                                                <h3 className="text-xl font-bold text-white">{listing.title}</h3>
                                                <span className="bg-gradient-to-r from-emerald-500/20 to-teal-500/20 text-emerald-400 px-3 py-1 rounded-full text-xs font-semibold border border-emerald-500/30">
                                                    {listing.category}
                                                </span>
                                            </div>
                                            <p className="text-gray-300 mb-4 leading-relaxed">{listing.description}</p>
                                            <div className="flex justify-between items-center mb-4">
                                                <div>
                                                    <span className="text-3xl font-bold gradient-text">₸{listing.price}</span>
                                                    {listing.originalPrice && (
                                                        <span className="text-sm text-gray-500 line-through ml-2">₸{listing.originalPrice}</span>
                                                    )}
                                                </div>
                                                <span className="text-gray-400 font-semibold">{listing.quantity}</span>
                                            </div>
                                            <div className="pt-4 border-t border-white/10 flex justify-between text-sm text-gray-400">
                                                <span className="flex items-center gap-1">📍 {listing.location}</span>
                                                <span className="flex items-center gap-1">🕐 {listing.time}</span>
                                            </div>
                                            <div className="mt-4 p-3 bg-gradient-to-r from-amber-500/10 to-orange-500/10 border border-amber-500/30 rounded-xl">
                                                <span className="text-xs text-amber-400 font-semibold">🔒 Точный адрес откроется после оплаты</span>
                                            </div>
                                        </div>
                                    </div>
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // Детали лота
        function LotDetail({ navigate, lot }) {
            const [isPaid, setIsPaid] = useState(false);
            const [showPayment, setShowPayment] = useState(false);

            if (!lot) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <h1 className="text-2xl text-white mb-4">Лот не найден</h1>
                            <button onClick={() => navigate('marketplace')} className="btn-gradient text-gray-900 px-6 py-3 rounded-xl">
                                ← Вернуться в маркетплейс
                            </button>
                        </div>
                    </div>
                );
            }

            const handlePayment = () => {
                setIsPaid(true);
                setShowPayment(false);
            };

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <div className="absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-cyan-500/10"></div>

                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <button onClick={() => navigate('marketplace')} className="text-gray-300 hover:text-white">
                                ← Вернуться в маркетплейс
                            </button>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-4xl mx-auto px-4 py-8">
                        <div className="glass-effect rounded-3xl p-8">
                            <div className="h-64 bg-gradient-to-br from-emerald-500/20 to-cyan-500/20 rounded-2xl flex items-center justify-center mb-6">
                                <span className="text-6xl">
                                    {lot.category === 'Еда' ? '🍽️' : lot.category === 'Пластик' ? '♻️' : '👕'}
                                </span>
                            </div>

                            <h1 className="text-3xl font-bold text-white mb-4">{lot.title}</h1>
                            <p className="text-gray-300 mb-6">{lot.description}</p>

                            <div className="grid grid-cols-2 gap-4 mb-6">
                                <div className="glass-effect rounded-xl p-4">
                                    <div className="text-sm text-gray-400 mb-1">Цена</div>
                                    <div className="text-2xl font-bold gradient-text">₸{lot.price}</div>
                                    {lot.originalPrice && (
                                        <div className="text-sm text-gray-500 line-through">₸{lot.originalPrice}</div>
                                    )}
                                </div>
                                <div className="glass-effect rounded-xl p-4">
                                    <div className="text-sm text-gray-400 mb-1">Количество</div>
                                    <div className="text-xl font-bold text-white">{lot.quantity}</div>
                                </div>
                                <div className="glass-effect rounded-xl p-4">
                                    <div className="text-sm text-gray-400 mb-1">Локация</div>
                                    <div className="text-white font-semibold">
                                        {isPaid ? 'Rixos Almaty, ул. Аль-Фараби 48' : lot.location}
                                    </div>
                                    {!isPaid && (
                                        <div className="text-xs text-amber-400 mt-1">🔒 Скрыто до оплаты</div>
                                    )}
                                </div>
                                <div className="glass-effect rounded-xl p-4">
                                    <div className="text-sm text-gray-400 mb-1">Время забора</div>
                                    <div className="text-white font-semibold">{lot.time}</div>
                                </div>
                            </div>

                            {!isPaid && !showPayment && (
                                <button onClick={() => setShowPayment(true)} className="w-full btn-gradient ripple-effect text-gray-900 py-4 rounded-xl font-bold text-lg">
                                    💳 Оплатить ₸{lot.price}
                                </button>
                            )}

                            {showPayment && !isPaid && (
                                <div className="glass-effect rounded-2xl p-6 mb-6">
                                    <h3 className="text-xl font-bold text-white mb-4">Оплата картой</h3>
                                    <div className="space-y-4">
                                        <input type="text" placeholder="Номер карты" className="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white" />
                                        <div className="grid grid-cols-2 gap-4">
                                            <input type="text" placeholder="MM/YY" className="px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white" />
                                            <input type="text" placeholder="CVV" className="px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white" />
                                        </div>
                                        <input type="text" placeholder="Имя владельца" className="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white" />
                                        <div className="text-sm text-gray-400 text-center">
                                            Комиссия 6% • Безопасная оплата
                                        </div>
                                        <button onClick={(e) => { addRipple(e); handlePayment(); }} className="w-full btn-gradient ripple-effect text-gray-900 py-3 rounded-xl font-bold">
                                            Оплатить ₸{Math.round(lot.price * 1.06)}
                                        </button>
                                    </div>
                                </div>
                            )}

                            {isPaid && (
                                <div className="glass-effect rounded-2xl p-6 text-center">
                                    <div className="text-6xl mb-4">✅</div>
                                    <h3 className="text-2xl font-bold text-white mb-4">Оплата успешна!</h3>
                                    <div className="bg-white rounded-xl p-8 mb-6">
                                        <div className="text-8xl">📱</div>
                                        <div className="text-gray-600 mt-4">QR-код для получения</div>
                                        <div className="text-sm text-gray-500 mt-2">Покажите на ресепшене</div>
                                    </div>
                                    <div className="glass-effect rounded-xl p-4 text-left">
                                        <div className="text-sm text-gray-400 mb-2">Адрес отеля:</div>
                                        <div className="text-white font-bold">Rixos Almaty</div>
                                        <div className="text-gray-300">ул. Аль-Фараби 48, Алматы</div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Запросы
        function Requests({ navigate }) {
            const requests = [
                {
                    id: 1,
                    type: 'Ищу',
                    title: 'Ищу свежие овощи для столовой',
                    description: 'Нужны овощи для общественной столовой на 50 человек',
                    category: 'Еда',
                    urgency: 'Срочно'
                },
                {
                    id: 2,
                    type: 'Предлагаю',
                    title: 'Излишки пластиковых бутылок',
                    description: 'Чистые пластиковые бутылки, 50кг в неделю',
                    category: 'Пластик',
                    urgency: 'Обычно'
                }
            ];

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <div className="absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-cyan-500/10"></div>

                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex justify-between items-center">
                                <button onClick={() => navigate('landing')} className="flex items-center space-x-3">
                                    <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}>
                                        <LogoIcon size={20} color="white" />
                                    </div>
                                    <span className="text-xl font-bold text-white">EcoLoop</span>
                                </button>
                                <div className="flex items-center gap-4">
                                    <button onClick={() => navigate('landing')} className="text-gray-500 hover:text-gray-300 text-sm transition">Главная</button>
                                    <button onClick={() => navigate('marketplace')} className="text-gray-300 hover:text-white text-sm transition">Маркетплейс</button>
                                    <button onClick={() => navigate('dashboard')} className="text-gray-300 hover:text-white text-sm transition">Кабинет</button>
                                </div>
                            </div>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-7xl mx-auto px-4 py-8">
                        <div className="flex justify-between items-center mb-8">
                            <h1 className="text-4xl font-bold gradient-text">Запросы</h1>
                            <button onClick={(e) => { addRipple(e); navigate('create-request'); }} className="btn-gradient ripple-effect text-gray-900 px-6 py-3 rounded-xl font-semibold">
                                Создать запрос
                            </button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {requests.map(request => (
                                <div key={request.id} className="glass-effect rounded-2xl p-6 card-hover">
                                    <div className="flex justify-between items-start mb-4">
                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                                            request.type === 'Ищу' 
                                                ? 'bg-emerald-500/20 text-emerald-400' 
                                                : 'bg-teal-500/20 text-teal-400'
                                        }`}>
                                            {request.type === 'Ищу' ? '🔍 Ищу' : '📤 Предлагаю'}
                                        </span>
                                        <span className={`px-2 py-1 rounded-full text-xs ${
                                            request.urgency === 'Срочно' 
                                                ? 'bg-red-500/20 text-red-400' 
                                                : 'bg-emerald-500/20 text-emerald-400'
                                        }`}>
                                            {request.urgency}
                                        </span>
                                    </div>
                                    <h3 className="text-xl font-bold text-white mb-2">{request.title}</h3>
                                    <p className="text-gray-300 mb-4">{request.description}</p>
                                    <div className="flex justify-between items-center">
                                        <span className="text-gray-400">
                                            {request.category === 'Еда' ? '🍽️' : '♻️'} {request.category}
                                        </span>
                                        <button className="text-emerald-400 hover:text-emerald-300 font-semibold">
                                            Откликнуться →
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // Создание запроса
        function CreateRequest({ navigate }) {
            const [step, setStep] = useState(1);
            const [formData, setFormData] = useState({
                type: '', category: '', title: '', description: '',
                volume: '', budget: '', district: '', urgency: 'normal', regularity: 'once', contactPhone: ''
            });

            const [toast, setToast] = useState(null);
            const inputCls = "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition";
            const handleSubmit = () => {
                sendToTelegram('request', formData);
                setToast('Запрос успешно создан!');
                setTimeout(() => navigate('requests'), 1500);
            };

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    {toast && <Toast message={toast} onClose={() => setToast(null)} />}

                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <button onClick={() => navigate('requests')} className="text-gray-300 hover:text-white">← Назад к запросам</button>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-2xl mx-auto px-4 py-12">
                        {/* Прогресс */}
                        <div className="flex items-center justify-center gap-3 mb-8">
                            {[1,2,3].map(s => (
                                <div key={s} className="flex items-center gap-3">
                                    <div className={`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all ${step >= s ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-white/5 text-gray-600 border border-white/10'}`}>{s}</div>
                                    {s < 3 && <div className={`w-12 h-px ${step > s ? 'bg-emerald-500/30' : 'bg-white/10'}`}></div>}
                                </div>
                            ))}
                        </div>

                        <div className="p-8 rounded-2xl border border-white/10" style={{background: 'rgba(255,255,255,0.02)'}}>
                            {step === 1 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-white section-title">Тип и категория</h2>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-3">Тип запроса</label>
                                        <div className="grid grid-cols-2 gap-4">
                                            {[{v:'Ищу',icon:'🔍',c:'emerald'},{v:'Предлагаю',icon:'📤',c:'teal'}].map(t => (
                                                <button key={t.v} onClick={() => setFormData({...formData, type: t.v})}
                                                    className={`p-6 rounded-xl border transition ${formData.type === t.v ? `border-${t.c}-500 bg-${t.c}-500/10` : 'border-white/8 hover:border-white/20'}`}
                                                    style={{background: formData.type === t.v ? undefined : 'rgba(255,255,255,0.02)'}}>
                                                    <div className="text-3xl mb-2">{t.icon}</div>
                                                    <div className="text-white font-semibold text-sm">{t.v}</div>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-3">Категория</label>
                                        <div className="grid grid-cols-3 gap-4">
                                            {[{v:'Еда',i:'🍽️'},{v:'Пластик',i:'♻️'},{v:'Текстиль',i:'👕'},{v:'Стекло',i:'🫙'},{v:'Металл',i:'🔩'},{v:'Органика',i:'🌱'}].map(c => (
                                                <button key={c.v} onClick={() => setFormData({...formData, category: c.v})}
                                                    className={`p-4 rounded-xl border transition text-center ${formData.category === c.v ? 'border-emerald-500/40 bg-emerald-500/5' : 'border-white/8 hover:border-white/20'}`}
                                                    style={{background: formData.category === c.v ? undefined : 'rgba(255,255,255,0.02)'}}>
                                                    <div className="text-xl mb-1">{c.i}</div>
                                                    <div className="text-white text-xs">{c.v}</div>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    {formData.type && formData.category && (
                                        <button onClick={(e) => { addRipple(e); setStep(2); }} className="w-full btn-gradient ripple-effect text-gray-900 py-3 rounded-xl font-bold">Далее</button>
                                    )}
                                </div>
                            )}

                            {step === 2 && (
                                <div className="space-y-5">
                                    <h2 className="text-2xl font-bold text-white section-title">Детали запроса</h2>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Заголовок *</label>
                                        <input type="text" value={formData.title} onChange={(e) => setFormData({...formData, title: e.target.value})} className={inputCls} placeholder="Ищу свежие овощи для столовой" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Описание</label>
                                        <textarea value={formData.description} onChange={(e) => setFormData({...formData, description: e.target.value})} rows={3} className={inputCls} placeholder="Подробно опишите запрос..." />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Объём / кол-во</label>
                                            <input type="text" value={formData.volume} onChange={(e) => setFormData({...formData, volume: e.target.value})} className={inputCls} placeholder="50 кг / 100 шт" />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Бюджет (₸)</label>
                                            <input type="text" value={formData.budget} onChange={(e) => setFormData({...formData, budget: e.target.value})} className={inputCls} placeholder="до 50 000" />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Район / город</label>
                                            <input type="text" value={formData.district} onChange={(e) => setFormData({...formData, district: e.target.value})} className={inputCls} placeholder="Алматы, Медеуский" />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Срочность</label>
                                            <select value={formData.urgency} onChange={(e) => setFormData({...formData, urgency: e.target.value})} className={inputCls} style={{background: '#141414'}}>
                                                <option value="normal">Обычная</option>
                                                <option value="urgent">Срочно (24ч)</option>
                                                <option value="week">В течение недели</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Регулярность</label>
                                            <select value={formData.regularity} onChange={(e) => setFormData({...formData, regularity: e.target.value})} className={inputCls} style={{background: '#141414'}}>
                                                <option value="once">Разовый</option>
                                                <option value="weekly">Еженедельно</option>
                                                <option value="monthly">Ежемесячно</option>
                                                <option value="permanent">Постоянный</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Контактный телефон</label>
                                            <input type="tel" value={formData.contactPhone} onChange={(e) => setFormData({...formData, contactPhone: e.target.value})} className={inputCls} placeholder="+7 (777) ..." />
                                        </div>
                                    </div>
                                    <div className="flex gap-4 pt-2">
                                        <button onClick={() => setStep(1)} className="flex-1 py-3 rounded-xl font-bold text-white border border-white/10 hover:border-white/20 transition">← Назад</button>
                                        <button onClick={(e) => { if (formData.title) { addRipple(e); setStep(3); } }} disabled={!formData.title} className={`flex-1 py-3 rounded-xl font-bold ripple-effect transition-all ${formData.title ? 'btn-gradient text-gray-900' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}>Далее</button>
                                    </div>
                                </div>
                            )}

                            {step === 3 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-white section-title">Предпросмотр</h2>
                                    <div className="p-6 rounded-xl border border-white/10" style={{background: 'rgba(255,255,255,0.03)'}}>
                                        <div className="flex items-center gap-3 mb-4">
                                            <span className={`px-3 py-1 rounded-full text-xs font-semibold ${formData.type === 'Ищу' ? 'bg-emerald-500/20 text-emerald-400' : 'bg-teal-500/20 text-teal-400'}`}>{formData.type}</span>
                                            <span className="px-3 py-1 rounded-full text-xs font-semibold bg-white/5 text-gray-400">{formData.category}</span>
                                            {formData.urgency === 'urgent' && <span className="px-3 py-1 rounded-full text-xs font-semibold bg-red-500/20 text-red-400">Срочно</span>}
                                        </div>
                                        <h3 className="text-lg font-bold text-white mb-2">{formData.title}</h3>
                                        {formData.description && <p className="text-gray-400 text-sm mb-4">{formData.description}</p>}
                                        <div className="grid grid-cols-2 gap-3 text-sm">
                                            {formData.volume && <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Объём:</span> <span className="text-white">{formData.volume}</span></div>}
                                            {formData.budget && <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Бюджет:</span> <span className="text-white">₸{formData.budget}</span></div>}
                                            {formData.district && <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Район:</span> <span className="text-white">{formData.district}</span></div>}
                                            <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Регулярность:</span> <span className="text-white">{{once:'Разовый',weekly:'Еженедельно',monthly:'Ежемесячно',permanent:'Постоянный'}[formData.regularity]}</span></div>
                                        </div>
                                    </div>
                                    <div className="flex gap-4">
                                        <button onClick={() => setStep(2)} className="flex-1 py-3 rounded-xl font-bold text-white border border-white/10 hover:border-white/20 transition">← Назад</button>
                                        <button onClick={(e) => { addRipple(e); handleSubmit(); }} className="flex-1 btn-gradient ripple-effect text-gray-900 py-3 rounded-xl font-bold">Опубликовать</button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Кабинет отеля
        function Dashboard({ navigate }) {
            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />

                    <header className="relative z-10 glass-effect border-b border-white/10 fade-in">
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h1 className="text-3xl font-bold gradient-text">Кабинет отеля</h1>
                                    <p className="text-gray-400 mt-1">Rixos Almaty Hotel</p>
                                </div>
                                <div className="flex items-center gap-4">
                                    <button onClick={() => navigate('analytics')} className="text-gray-400 hover:text-white text-sm nav-link transition">Аналитика</button>
                                    <button onClick={() => navigate('marketplace')} className="text-gray-400 hover:text-white text-sm nav-link transition">Маркетплейс</button>
                                    <button onClick={() => navigate('requests')} className="text-gray-400 hover:text-white text-sm nav-link transition">Запросы</button>
                                    <button onClick={() => navigate('payouts')} className="text-gray-400 hover:text-white text-sm nav-link transition">Выплаты</button>
                                    <button onClick={() => navigate('admin')} className="text-gray-400 hover:text-white text-sm nav-link transition">Админ</button>
                                    <button onClick={() => navigate('landing')} className="text-gray-500 hover:text-gray-300 text-sm transition">Главная</button>
                                </div>
                            </div>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-7xl mx-auto px-4 py-8">
                        {/* Статистика */}
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                            <div className="stat-card text-center">
                                <div className="text-4xl font-bold gradient-text mb-2">₸284,750</div>
                                <div className="text-gray-400 text-sm">Всего заработано</div>
                                <div className="mt-3 text-xs text-emerald-400">↗ +18% за неделю</div>
                            </div>
                            <div className="stat-card text-center">
                                <div className="text-4xl font-bold gradient-text mb-2">47</div>
                                <div className="text-gray-400 text-sm">Лотов продано</div>
                                <div className="mt-3 text-xs text-emerald-400">↗ +12 новых</div>
                            </div>
                            <div className="stat-card text-center">
                                <div className="text-4xl font-bold gradient-text mb-2">1,250кг</div>
                                <div className="text-gray-400 text-sm">Отходов сокращено</div>
                                <div className="mt-3 text-xs text-emerald-400">↗ +340кг за месяц</div>
                            </div>
                            <div className="stat-card text-center">
                                <div className="text-4xl font-bold gradient-text mb-2">4.8★</div>
                                <div className="text-gray-400 text-sm">Рейтинг</div>
                                <div className="mt-3 text-xs text-emerald-400">↗ 127 отзывов</div>
                            </div>
                        </div>

                        {/* Действия */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <button onClick={() => navigate('create-lot')} className="mirror-card p-10 text-left group">
                                <div className="w-16 h-16 bg-gradient-to-br from-emerald-500/30 to-teal-500/30 rounded-2xl flex items-center justify-center mb-6 pulse-glow">
                                    <span className="text-3xl">➕</span>
                                </div>
                                <h3 className="text-2xl font-bold text-white mb-4">Создать новый лот</h3>
                                <p className="text-gray-300 mb-6 leading-relaxed">Разместите еду, вторсырьё или текстиль на продажу</p>
                                <div className="flex items-center text-emerald-400 font-semibold">
                                    <span>Создать лот</span>
                                    <span className="ml-2 group-hover:ml-4 transition-all">→</span>
                                </div>
                            </button>
                            
                            <button onClick={() => navigate('payouts')} className="mirror-card p-10 text-left group">
                                <div className="w-16 h-16 bg-gradient-to-br from-cyan-500/30 to-blue-500/30 rounded-2xl flex items-center justify-center mb-6 pulse-glow">
                                    <span className="text-3xl">💰</span>
                                </div>
                                <h3 className="text-2xl font-bold text-white mb-4">Посмотреть выплаты</h3>
                                <p className="text-gray-300 mb-6 leading-relaxed">Отслеживайте доходы и историю платежей</p>
                                <div className="flex items-center text-emerald-400 font-semibold">
                                    <span>Смотреть выплаты</span>
                                    <span className="ml-2 group-hover:ml-4 transition-all">→</span>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Создание лота
        function CreateLot({ navigate }) {
            const [step, setStep] = useState(1);
            const [toast, setToast] = useState(null);
            const [lot, setLot] = useState({
                category: '', title: '', description: '', weight: '', price: '', originalPrice: '', pickupTime: '', photos: []
            });

            const categories = [
                { value: 'food', label: 'Еда', icon: '🍽️', color: 'emerald' },
                { value: 'plastic', label: 'Пластик', icon: '♻️', color: 'blue' },
                { value: 'textile', label: 'Текстиль', icon: '👕', color: 'amber' }
            ];

            const handlePublish = () => {
                setToast('Лот успешно опубликован!');
                setTimeout(() => navigate('dashboard'), 1500);
            };

            const inputCls = "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-emerald-500/50 transition";

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    {toast && <Toast message={toast} onClose={() => setToast(null)} />}

                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <button onClick={() => navigate('dashboard')} className="text-gray-300 hover:text-white transition">← Вернуться в кабинет</button>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-2xl mx-auto px-4 py-10">
                        {/* Прогресс */}
                        <div className="flex items-center justify-center gap-3 mb-10">
                            {[1,2,3].map(s => (
                                <div key={s} className="flex items-center gap-3">
                                    <div className={`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all ${step >= s ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-white/5 text-gray-600 border border-white/10'}`}>{s}</div>
                                    {s < 3 && <div className={`w-12 h-px ${step > s ? 'bg-emerald-500/30' : 'bg-white/10'}`}></div>}
                                </div>
                            ))}
                        </div>

                        <div className="p-8 rounded-2xl border border-white/10" style={{background: 'rgba(255,255,255,0.02)'}}>
                            {step === 1 && (
                                <div>
                                    <h2 className="text-2xl font-bold text-white mb-6 section-title">Категория лота</h2>
                                    <div className="grid grid-cols-3 gap-4 mb-6">
                                        {categories.map(c => (
                                            <button key={c.value} onClick={() => setLot({...lot, category: c.value})} className={`p-6 rounded-xl border text-center transition-all ${lot.category === c.value ? 'border-emerald-500/40 bg-emerald-500/5' : 'border-white/8 hover:border-white/20'}`} style={{background: lot.category === c.value ? undefined : 'rgba(255,255,255,0.02)'}}>
                                                <div className="text-3xl mb-2">{c.icon}</div>
                                                <div className="text-white text-sm font-semibold">{c.label}</div>
                                            </button>
                                        ))}
                                    </div>
                                    {lot.category && (
                                        <button onClick={(e) => { addRipple(e); setStep(2); }} className="w-full btn-gradient ripple-effect text-gray-900 py-3 rounded-xl font-bold">Далее</button>
                                    )}
                                </div>
                            )}

                            {step === 2 && (
                                <div className="space-y-5">
                                    <h2 className="text-2xl font-bold text-white mb-2 section-title">Детали лота</h2>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Название *</label>
                                        <input type="text" value={lot.title} onChange={(e) => setLot({...lot, title: e.target.value})} placeholder="Magic Box от шведского стола" className={inputCls} />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Описание</label>
                                        <textarea value={lot.description} onChange={(e) => setLot({...lot, description: e.target.value})} rows={3} placeholder="Свежая выпечка, салаты, нарезка..." className={inputCls} />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Вес / кол-во *</label>
                                            <input type="text" value={lot.weight} onChange={(e) => setLot({...lot, weight: e.target.value})} placeholder="5 кг" className={inputCls} />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Время самовывоза *</label>
                                            <input type="text" value={lot.pickupTime} onChange={(e) => setLot({...lot, pickupTime: e.target.value})} placeholder="21:00 — 22:00" className={inputCls} />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Цена (₸) *</label>
                                            <input type="number" value={lot.price} onChange={(e) => setLot({...lot, price: e.target.value})} placeholder="500" className={inputCls} />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-300 mb-1.5">Рыночная цена (₸)</label>
                                            <input type="number" value={lot.originalPrice} onChange={(e) => setLot({...lot, originalPrice: e.target.value})} placeholder="1500" className={inputCls} />
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-300 mb-1.5">Фото</label>
                                        <div className="upload-area">
                                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#8EA99A" strokeWidth="1.5" className="mx-auto mb-3"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                                            <p className="text-sm text-gray-400">Перетащите фото или нажмите для загрузки</p>
                                            <p className="text-xs text-gray-600 mt-1">JPG, PNG до 5MB</p>
                                        </div>
                                    </div>
                                    <div className="flex gap-4 pt-2">
                                        <button onClick={() => setStep(1)} className="flex-1 py-3 rounded-xl font-bold text-white border border-white/10 hover:border-white/20 transition">← Назад</button>
                                        <button onClick={(e) => { if (lot.title && lot.weight && lot.price) { addRipple(e); setStep(3); } }} disabled={!lot.title || !lot.weight || !lot.price} className={`flex-1 py-3 rounded-xl font-bold ripple-effect transition-all ${lot.title && lot.weight && lot.price ? 'btn-gradient text-gray-900' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}>Далее</button>
                                    </div>
                                </div>
                            )}

                            {step === 3 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-white mb-2 section-title">Предпросмотр</h2>
                                    <div className="p-6 rounded-xl border border-white/10" style={{background: 'rgba(255,255,255,0.03)'}}>
                                        <div className="flex justify-between items-start mb-4">
                                            <h3 className="text-lg font-bold text-white">{lot.title}</h3>
                                            <span className="text-xs px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-400 border border-emerald-500/30">{categories.find(c => c.value === lot.category)?.label}</span>
                                        </div>
                                        {lot.description && <p className="text-gray-400 text-sm mb-4">{lot.description}</p>}
                                        <div className="grid grid-cols-2 gap-3 text-sm">
                                            <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Вес:</span> <span className="text-white font-semibold">{lot.weight}</span></div>
                                            <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Самовывоз:</span> <span className="text-white font-semibold">{lot.pickupTime || '—'}</span></div>
                                            <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Цена:</span> <span className="text-white font-bold">₸{lot.price}</span></div>
                                            <div className="p-3 rounded-lg bg-white/5"><span className="text-gray-500">Рыночная:</span> <span className="text-gray-400 line-through">₸{lot.originalPrice || '—'}</span></div>
                                        </div>
                                        {lot.originalPrice && lot.price && (
                                            <div className="mt-4 text-center">
                                                <span className="text-sm text-emerald-400 font-bold">Скидка {Math.round((1 - lot.price / lot.originalPrice) * 100)}%</span>
                                            </div>
                                        )}
                                    </div>
                                    <div className="flex gap-4">
                                        <button onClick={() => setStep(2)} className="flex-1 py-3 rounded-xl font-bold text-white border border-white/10 hover:border-white/20 transition">← Назад</button>
                                        <button onClick={(e) => { addRipple(e); handlePublish(); }} className="flex-1 btn-gradient ripple-effect text-gray-900 py-3 rounded-xl font-bold">Опубликовать</button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Выплаты
        function SellerPayouts({ navigate }) {
            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />

                    <header className="relative z-10 glass-effect border-b border-white/10 fade-in">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <button onClick={() => navigate('dashboard')} className="text-gray-300 hover:text-emerald-400 transition font-semibold flex items-center gap-2">
                                <span>←</span>
                                <span>Вернуться в кабинет</span>
                            </button>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-7xl mx-auto px-4 py-8">
                        <h1 className="text-5xl font-bold gradient-text mb-12">Выплаты продавцу</h1>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                            <div className="stat-card">
                                <div className="text-sm text-gray-400 mb-2">Всего заработано</div>
                                <div className="text-4xl font-bold gradient-text mb-2">₸284,750</div>
                                <div className="text-xs text-emerald-400">↗ +34% за месяц</div>
                            </div>
                            <div className="stat-card">
                                <div className="text-sm text-gray-400 mb-2">Ожидает выплаты</div>
                                <div className="text-4xl font-bold text-amber-400 mb-2">₸12,500</div>
                                <div className="text-xs text-amber-400">⏱ Выплата в понедельник</div>
                            </div>
                            <div className="stat-card">
                                <div className="text-sm text-gray-400 mb-2">Последняя выплата</div>
                                <div className="text-4xl font-bold text-emerald-400 mb-2">₸8,750</div>
                                <div className="text-xs text-gray-400">15 февраля 2026</div>
                            </div>
                        </div>

                        <div className="mirror-card p-8">
                            <div className="flex justify-between items-center mb-6">
                                <h3 className="text-2xl font-bold text-white">Последние транзакции</h3>
                                <button className="text-emerald-400 hover:text-emerald-300 font-semibold text-sm">
                                    Экспорт →
                                </button>
                            </div>
                            <div className="space-y-4">
                                {[
                                    { id: 1, title: 'Magic Box от 4★ отеля', amount: 500, fee: 30, date: '18.02.2026', status: 'completed' },
                                    { id: 2, title: 'Пластиковая тара', amount: 200, fee: 12, date: '17.02.2026', status: 'completed' },
                                    { id: 3, title: 'Постельное бельё', amount: 150, fee: 9, date: '16.02.2026', status: 'completed' },
                                    { id: 4, title: 'Magic Box от 5★ отеля', amount: 750, fee: 45, date: '15.02.2026', status: 'pending' }
                                ].map((tx, index) => (
                                    <div key={tx.id} className="flex justify-between items-center p-5 glass-effect rounded-2xl hover:border-emerald-500/30 transition-all fade-in" style={{animationDelay: `${index * 0.1}s`}}>
                                        <div className="flex items-center gap-4">
                                            <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${
                                                tx.status === 'completed' 
                                                    ? 'bg-emerald-500/20 text-emerald-400' 
                                                    : 'bg-amber-500/20 text-amber-400'
                                            }`}>
                                                {tx.status === 'completed' ? '✓' : '⏱'}
                                            </div>
                                            <div>
                                                <div className="text-white font-semibold">{tx.title}</div>
                                                <div className="text-sm text-gray-400">{tx.date}</div>
                                            </div>
                                        </div>
                                        <div className="text-right">
                                            <div className="text-white font-bold text-lg">₸{tx.amount - tx.fee}</div>
                                            <div className="text-xs text-gray-400">Комиссия: ₸{tx.fee} (6%)</div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ===== FIREBASE INIT =====
        const firebaseConfig = {
            apiKey: "AIzaSyD7-uqvnY8lb8Xb3DIJTn3VdAeMXR7A-qM",
            authDomain: "teenx-hub.firebaseapp.com",
            projectId: "teenx-hub",
            storageBucket: "teenx-hub.firebasestorage.app",
            messagingSenderId: "230323449629",
            appId: "1:230323449629:web:d35086d70526caaa6c7bf4"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ===== TELEGRAM WEBHOOK =====
        const TG_BOT_TOKEN = '8547995948:AAGP-JDNJowAvmTqMK04n9rNZ16519dp2C8';
        const TG_CHAT_ID = '7682446178';

        async function sendToTelegram(type, data) {
            const labels = {
                callback: '📞 Обратный звонок',
                hotel: '🏨 Заявка отеля',
                request: '📋 Новый запрос',
                buyer: '👤 Регистрация покупателя'
            };
            
            // Сохраняем в Firestore
            try {
                await db.collection('submissions').add({
                    type,
                    data,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'new'
                });
                console.log('✅ Сохранено в Firestore');
            } catch (err) {
                console.error('❌ Ошибка Firestore:', err);
            }

            // Отправляем через бота (с кнопками одобрения)
            const BOT_API = 'https://ecoloop-idd1.onrender.com';
            try {
                const res = await fetch(`${BOT_API}/api/submit`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type, data })
                });
                const result = await res.json();
                console.log('✅ Отправлено через бота:', result);
            } catch (err) {
                console.warn('Bot API failed, fallback to direct TG:', err);
                // Фолбэк: напрямую в Telegram
                let text = `${labels[type] || '📩 Новая заявка'}\n\n`;
                Object.entries(data).forEach(([k, v]) => {
                    if (v && typeof v === 'string') text += `${k}: ${v}\n`;
                });
                text += `\n🕐 ${new Date().toLocaleString('ru-RU')}`;
                fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: TG_CHAT_ID, text, parse_mode: 'HTML' })
                }).catch(e => console.warn('TG fallback failed:', e));
            }
        }

        // ===== АДМИН-ПАНЕЛЬ =====
        function AdminPanel({ navigate }) {
            const [tab, setTab] = useState('lots');
            const [toast, setToast] = useState(null);

            const lots = [
                { id: 1, title: 'Magic Box от Rixos', hotel: 'Rixos Almaty', price: 500, status: 'pending', date: '20.02.2026' },
                { id: 2, title: 'Пластиковая тара', hotel: 'Hilton Astana', price: 200, status: 'active', date: '19.02.2026' },
                { id: 3, title: 'Постельное бельё', hotel: 'Marriott Almaty', price: 150, status: 'active', date: '18.02.2026' },
                { id: 4, title: 'Органические отходы', hotel: 'Holiday Inn', price: 100, status: 'rejected', date: '17.02.2026' },
            ];
            const users = [
                { id: 1, name: 'Rixos Almaty', type: 'hotel', status: 'active', lots: 12, revenue: '₸284,750' },
                { id: 2, name: 'Иван Петров', type: 'buyer', status: 'active', orders: 8, spent: '₸12,400' },
                { id: 3, name: 'Hilton Astana', type: 'hotel', status: 'pending', lots: 0, revenue: '₸0' },
                { id: 4, name: 'Айгуль Сатпаева', type: 'buyer', status: 'active', orders: 3, spent: '₸4,200' },
            ];
            const complaints = [
                { id: 1, from: 'Иван Петров', lot: 'Magic Box #47', issue: 'Продукт был просрочен', date: '20.02.2026', status: 'pending' },
                { id: 2, from: 'Айгуль Сатпаева', lot: 'Пластик #12', issue: 'Не соответствует описанию', date: '19.02.2026', status: 'pending' },
            ];

            const stats = [
                { label: 'Всего лотов', value: '247', change: '+18%' },
                { label: 'Пользователей', value: '1,024', change: '+12%' },
                { label: 'GMV за месяц', value: '₸1.2M', change: '+34%' },
                { label: 'Комиссия', value: '₸72,000', change: '+28%' },
            ];

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    {toast && <Toast message={toast} onClose={() => setToast(null)} />}

                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}><LogoIcon size={20} color="white" /></div>
                                <div>
                                    <span className="text-lg font-bold text-white">EcoLoop</span>
                                    <span className="ml-2 text-xs px-2 py-0.5 rounded-full bg-amber-500/20 text-amber-400 font-semibold">Admin</span>
                                </div>
                            </div>
                            <div className="flex items-center gap-3">
                                <button onClick={() => navigate('analytics')} className="text-gray-400 hover:text-white text-sm nav-link transition">Аналитика</button>
                                <button onClick={() => navigate('dashboard')} className="text-gray-400 hover:text-white text-sm nav-link transition">Кабинет</button>
                                <button onClick={() => navigate('landing')} className="text-gray-400 hover:text-white text-sm nav-link transition">Главная</button>
                            </div>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-7xl mx-auto px-4 py-8">
                        <h1 className="text-3xl font-bold text-white mb-8 section-title">Панель администратора</h1>

                        {/* Статистика */}
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                            {stats.map((s, i) => (
                                <div key={i} className="p-5 rounded-2xl border border-white/5 hover-glow" style={{background: 'rgba(255,255,255,0.02)'}}>
                                    <div className="text-xs text-gray-500 mb-1">{s.label}</div>
                                    <div className="text-2xl font-bold text-white counter-value">{s.value}</div>
                                    <div className="text-xs text-emerald-400 mt-1">{s.change}</div>
                                </div>
                            ))}
                        </div>

                        {/* Табы */}
                        <div className="flex gap-2 mb-6">
                            {[{v:'lots',l:'Модерация лотов'},{v:'users',l:'Пользователи'},{v:'complaints',l:'Жалобы'}].map(t => (
                                <button key={t.v} onClick={() => setTab(t.v)} className={`tab-btn ${tab === t.v ? 'active' : ''}`}>{t.l}</button>
                            ))}
                        </div>

                        {/* Модерация лотов */}
                        {tab === 'lots' && (
                            <div className="space-y-3">
                                {lots.map(lot => (
                                    <div key={lot.id} className="flex items-center justify-between p-5 rounded-2xl border border-white/8 hover-glow" style={{background: 'rgba(255,255,255,0.02)'}}>
                                        <div className="flex items-center gap-4">
                                            <div className="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-lg">
                                                {lot.title.includes('Magic') ? '🍽️' : lot.title.includes('Пластик') ? '♻️' : lot.title.includes('бельё') ? '👕' : '🌱'}
                                            </div>
                                            <div>
                                                <div className="text-white font-semibold text-sm">{lot.title}</div>
                                                <div className="text-xs text-gray-500">{lot.hotel} · {lot.date}</div>
                                            </div>
                                        </div>
                                        <div className="flex items-center gap-3">
                                            <span className="text-white font-bold text-sm">₸{lot.price}</span>
                                            <span className={`status-badge ${lot.status === 'active' ? 'status-active' : lot.status === 'pending' ? 'status-pending' : 'status-rejected'}`}>
                                                {lot.status === 'active' ? 'Активен' : lot.status === 'pending' ? 'На модерации' : 'Отклонён'}
                                            </span>
                                            {lot.status === 'pending' && (
                                                <div className="flex gap-1.5 ml-2">
                                                    <button onClick={() => setToast('Лот одобрен')} className="px-3 py-1.5 rounded-lg bg-emerald-500/15 text-emerald-400 text-xs font-semibold hover:bg-emerald-500/25 transition">Одобрить</button>
                                                    <button onClick={() => setToast('Лот отклонён')} className="px-3 py-1.5 rounded-lg bg-red-500/15 text-red-400 text-xs font-semibold hover:bg-red-500/25 transition">Отклонить</button>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Пользователи */}
                        {tab === 'users' && (
                            <div className="space-y-3">
                                {users.map(u => (
                                    <div key={u.id} className="flex items-center justify-between p-5 rounded-2xl border border-white/8 hover-glow" style={{background: 'rgba(255,255,255,0.02)'}}>
                                        <div className="flex items-center gap-4">
                                            <div className={`w-10 h-10 rounded-xl flex items-center justify-center text-sm font-bold ${u.type === 'hotel' ? 'bg-blue-500/15 text-blue-400' : 'bg-emerald-500/15 text-emerald-400'}`}>
                                                {u.type === 'hotel' ? 'H' : 'B'}
                                            </div>
                                            <div>
                                                <div className="text-white font-semibold text-sm">{u.name}</div>
                                                <div className="text-xs text-gray-500">{u.type === 'hotel' ? `${u.lots} лотов · ${u.revenue}` : `${u.orders} заказов · ${u.spent}`}</div>
                                            </div>
                                        </div>
                                        <div className="flex items-center gap-3">
                                            <span className={`status-badge ${u.status === 'active' ? 'status-active' : 'status-pending'}`}>
                                                {u.status === 'active' ? 'Активен' : 'Ожидает'}
                                            </span>
                                            {u.status === 'pending' && (
                                                <button onClick={() => setToast(`${u.name} верифицирован`)} className="px-3 py-1.5 rounded-lg bg-emerald-500/15 text-emerald-400 text-xs font-semibold hover:bg-emerald-500/25 transition">Верифицировать</button>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Жалобы */}
                        {tab === 'complaints' && (
                            <div className="space-y-3">
                                {complaints.map(c => (
                                    <div key={c.id} className="p-5 rounded-2xl border border-white/8 hover-glow" style={{background: 'rgba(255,255,255,0.02)'}}>
                                        <div className="flex justify-between items-start mb-3">
                                            <div>
                                                <div className="text-white font-semibold text-sm">{c.issue}</div>
                                                <div className="text-xs text-gray-500">{c.from} · Лот: {c.lot} · {c.date}</div>
                                            </div>
                                            <span className="status-badge status-pending">Открыта</span>
                                        </div>
                                        <div className="flex gap-2">
                                            <button onClick={() => setToast('Возврат оформлен')} className="px-3 py-1.5 rounded-lg bg-emerald-500/15 text-emerald-400 text-xs font-semibold hover:bg-emerald-500/25 transition">Возврат средств</button>
                                            <button onClick={() => setToast('Жалоба отклонена')} className="px-3 py-1.5 rounded-lg bg-white/5 text-gray-400 text-xs font-semibold hover:bg-white/10 transition">Отклонить</button>
                                            <button className="px-3 py-1.5 rounded-lg bg-white/5 text-gray-400 text-xs font-semibold hover:bg-white/10 transition">Связаться</button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // ===== ЛИЧНЫЙ КАБИНЕТ ПОКУПАТЕЛЯ =====
        function BuyerProfile({ navigate }) {
            const [tab, setTab] = useState('orders');
            const orders = [
                { id: 1, title: 'Magic Box от Rixos', price: 500, date: '20.02.2026', status: 'completed', hotel: 'Rixos Almaty' },
                { id: 2, title: 'Пластиковая тара', price: 200, date: '18.02.2026', status: 'completed', hotel: 'Hilton Astana' },
                { id: 3, title: 'Постельное бельё', price: 150, date: '15.02.2026', status: 'pickup', hotel: 'Marriott Almaty' },
            ];
            const favorites = [
                { id: 1, title: 'Magic Box от 5★', price: 750, hotel: 'Ritz-Carlton', discount: 50 },
                { id: 2, title: 'Органическая зелень', price: 300, hotel: 'Novotel Almaty', discount: 60 },
            ];

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}><LogoIcon size={20} color="white" /></div>
                                <span className="text-lg font-bold text-white">Мой профиль</span>
                            </div>
                            <div className="flex items-center gap-3">
                                <button onClick={() => navigate('marketplace')} className="text-gray-400 hover:text-white text-sm nav-link transition">Маркетплейс</button>
                                <button onClick={() => navigate('landing')} className="text-gray-400 hover:text-white text-sm nav-link transition">Главная</button>
                            </div>
                        </div>
                    </header>

                    <div className="relative z-10 max-w-5xl mx-auto px-4 py-8">
                        {/* Профиль карточка */}
                        <div className="p-6 rounded-2xl border border-white/8 mb-8 flex items-center gap-6" style={{background: 'rgba(255,255,255,0.02)'}}>
                            <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-500/20 to-teal-500/20 flex items-center justify-center text-2xl font-bold text-emerald-400">И</div>
                            <div className="flex-1">
                                <h2 className="text-xl font-bold text-white">Иван Петров</h2>
                                <p className="text-sm text-gray-500">ivan@example.com · +7 (777) 123-45-67 · Алматы</p>
                            </div>
                            <div className="text-right">
                                <div className="text-2xl font-bold text-white counter-value">₸5,600</div>
                                <div className="text-xs text-gray-500">Баланс</div>
                            </div>
                        </div>

                        {/* Статистика */}
                        <div className="grid grid-cols-3 gap-4 mb-8">
                            <div className="p-5 rounded-2xl border border-white/5 text-center" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="text-3xl font-bold text-white counter-value">8</div>
                                <div className="text-xs text-gray-500 mt-1">Заказов</div>
                            </div>
                            <div className="p-5 rounded-2xl border border-white/5 text-center" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="text-3xl font-bold text-white counter-value">₸12,400</div>
                                <div className="text-xs text-gray-500 mt-1">Сэкономлено</div>
                            </div>
                            <div className="p-5 rounded-2xl border border-white/5 text-center" style={{background: 'rgba(255,255,255,0.02)'}}>
                                <div className="text-3xl font-bold text-white counter-value">45кг</div>
                                <div className="text-xs text-gray-500 mt-1">CO₂ предотвращено</div>
                            </div>
                        </div>

                        {/* Табы */}
                        <div className="flex gap-2 mb-6">
                            {[{v:'orders',l:'Мои заказы'},{v:'favorites',l:'Избранное'}].map(t => (
                                <button key={t.v} onClick={() => setTab(t.v)} className={`tab-btn ${tab === t.v ? 'active' : ''}`}>{t.l}</button>
                            ))}
                        </div>

                        {tab === 'orders' && (
                            <div className="space-y-3">
                                {orders.map(o => (
                                    <div key={o.id} className="flex items-center justify-between p-5 rounded-2xl border border-white/8 hover-glow" style={{background: 'rgba(255,255,255,0.02)'}}>
                                        <div>
                                            <div className="text-white font-semibold text-sm">{o.title}</div>
                                            <div className="text-xs text-gray-500">{o.hotel} · {o.date}</div>
                                        </div>
                                        <div className="flex items-center gap-3">
                                            <span className="text-white font-bold">₸{o.price}</span>
                                            <span className={`status-badge ${o.status === 'completed' ? 'status-active' : 'status-pending'}`}>
                                                {o.status === 'completed' ? 'Получен' : 'Забрать'}
                                            </span>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {tab === 'favorites' && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {favorites.map(f => (
                                    <div key={f.id} className="p-5 rounded-2xl border border-white/8 hover-glow" style={{background: 'rgba(255,255,255,0.02)'}}>
                                        <div className="flex justify-between items-start mb-3">
                                            <h3 className="text-white font-semibold">{f.title}</h3>
                                            <span className="text-xs px-2 py-1 rounded-full bg-red-500/20 text-red-400">-{f.discount}%</span>
                                        </div>
                                        <p className="text-xs text-gray-500 mb-3">{f.hotel}</p>
                                        <div className="flex justify-between items-center">
                                            <span className="text-lg font-bold gradient-text">₸{f.price}</span>
                                            <button onClick={() => navigate('marketplace')} className="px-4 py-1.5 rounded-lg bg-emerald-500/15 text-emerald-400 text-xs font-semibold hover:bg-emerald-500/25 transition">Купить</button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // ===== АНАЛИТИКА С ДИАГРАММАМИ =====
        function Analytics({ navigate }) {
            const chartRef1 = useRef(null);
            const chartRef2 = useRef(null);
            const chartRef3 = useRef(null);
            const reportRef = useRef(null);

            useEffect(() => {
                if (!window.Chart) return;
                const chartOpts = { responsive: true, plugins: { legend: { labels: { color: '#999', font: { size: 11 } } } }, scales: { x: { ticks: { color: '#555' }, grid: { color: 'rgba(255,255,255,0.03)' } }, y: { ticks: { color: '#555' }, grid: { color: 'rgba(255,255,255,0.03)' } } } };

                const c1 = new Chart(chartRef1.current, {
                    type: 'bar',
                    data: {
                        labels: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн'],
                        datasets: [{
                            label: 'Продажи (₸)',
                            data: [45000, 62000, 78000, 95000, 110000, 142000],
                            backgroundColor: 'rgba(142,169,154,0.4)',
                            borderColor: '#8EA99A',
                            borderWidth: 1,
                            borderRadius: 6
                        }]
                    },
                    options: { ...chartOpts, plugins: { ...chartOpts.plugins, title: { display: true, text: 'Продажи по месяцам', color: '#fff', font: { size: 14 } } } }
                });

                const c2 = new Chart(chartRef2.current, {
                    type: 'doughnut',
                    data: {
                        labels: ['Еда', 'Пластик', 'Текстиль', 'Органика'],
                        datasets: [{
                            data: [45, 25, 18, 12],
                            backgroundColor: ['rgba(142,169,154,0.6)', 'rgba(91,130,145,0.6)', 'rgba(242,201,76,0.6)', 'rgba(122,91,81,0.6)'],
                            borderWidth: 0
                        }]
                    },
                    options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { color: '#999', padding: 16, font: { size: 11 } } }, title: { display: true, text: 'По категориям', color: '#fff', font: { size: 14 } } } }
                });

                const c3 = new Chart(chartRef3.current, {
                    type: 'line',
                    data: {
                        labels: ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'],
                        datasets: [{
                            label: 'Заказы',
                            data: [12, 19, 15, 22, 18, 25, 20],
                            borderColor: '#8EA99A',
                            backgroundColor: 'rgba(142,169,154,0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4,
                            pointBackgroundColor: '#8EA99A'
                        }, {
                            label: 'Новые пользователи',
                            data: [5, 8, 6, 10, 7, 12, 9],
                            borderColor: '#5B8291',
                            backgroundColor: 'rgba(91,130,145,0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4,
                            pointBackgroundColor: '#5B8291'
                        }]
                    },
                    options: { ...chartOpts, plugins: { ...chartOpts.plugins, title: { display: true, text: 'Активность за неделю', color: '#fff', font: { size: 14 } } } }
                });

                return () => { c1.destroy(); c2.destroy(); c3.destroy(); };
            }, []);

            const downloadPDF = () => {
                if (!window.jspdf) return;
                const doc = new jspdf.jsPDF();
                doc.setFontSize(20);
                doc.setTextColor(40);
                doc.text('EcoLoop - Отчёт аналитики', 20, 20);
                doc.setFontSize(10);
                doc.setTextColor(100);
                doc.text(`Дата: ${new Date().toLocaleDateString('ru-RU')}`, 20, 30);

                doc.setFontSize(12);
                doc.setTextColor(40);
                doc.text('Ключевые метрики:', 20, 45);
                const metrics = [
                    ['Общая выручка', '₸532,000'],
                    ['Всего заказов', '247'],
                    ['Средний чек', '₸2,154'],
                    ['Активных отелей', '18'],
                    ['CO₂ предотвращено', '4.2т'],
                    ['Комиссия платформы', '₸31,920'],
                ];
                metrics.forEach((m, i) => {
                    doc.setTextColor(100);
                    doc.text(m[0] + ':', 20, 55 + i * 8);
                    doc.setTextColor(40);
                    doc.text(m[1], 80, 55 + i * 8);
                });

                doc.text('Продажи по месяцам:', 20, 110);
                const months = ['Янв: ₸45,000', 'Фев: ₸62,000', 'Мар: ₸78,000', 'Апр: ₸95,000', 'Май: ₸110,000', 'Июн: ₸142,000'];
                months.forEach((m, i) => {
                    doc.setTextColor(80);
                    doc.text(m, 20, 120 + i * 7);
                });

                doc.setFontSize(8);
                doc.setTextColor(150);
                doc.text('Сгенерировано EcoLoop Platform · ecoloop.kz', 20, 280);

                doc.save('EcoLoop_Report_' + new Date().toISOString().split('T')[0] + '.pdf');
            };

            return (
                <div className="min-h-screen relative overflow-hidden">
                    <ParticlesBackground />
                    <header className="relative z-10 glass-effect border-b border-white/10">
                        <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{background: 'linear-gradient(135deg, #8EA99A, #5B8291)'}}><LogoIcon size={20} color="white" /></div>
                                <span className="text-lg font-bold text-white">Аналитика</span>
                            </div>
                            <div className="flex items-center gap-3">
                                <button onClick={downloadPDF} className="btn-gradient ripple-effect text-gray-900 px-5 py-2 rounded-xl font-bold text-xs">Скачать PDF</button>
                                <button onClick={() => navigate('admin')} className="text-gray-400 hover:text-white text-sm nav-link transition">Админ</button>
                                <button onClick={() => navigate('dashboard')} className="text-gray-400 hover:text-white text-sm nav-link transition">Кабинет</button>
                                <button onClick={() => navigate('landing')} className="text-gray-400 hover:text-white text-sm nav-link transition">Главная</button>
                            </div>
                        </div>
                    </header>

                    <div ref={reportRef} className="relative z-10 max-w-7xl mx-auto px-4 py-8">
                        {/* KPI */}
                        <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
                            {[
                                {l:'Общая выручка',v:'₸532K',c:'+34%'},
                                {l:'Заказов',v:'247',c:'+18%'},
                                {l:'Средний чек',v:'₸2,154',c:'+5%'},
                                {l:'Отелей',v:'18',c:'+3'},
                                {l:'CO₂',v:'4.2т',c:'сокращено'}
                            ].map((s,i) => (
                                <div key={i} className="p-5 rounded-2xl border border-white/5 hover-glow" style={{background:'rgba(255,255,255,0.02)'}}>
                                    <div className="text-xs text-gray-500 mb-1">{s.l}</div>
                                    <div className="text-2xl font-bold text-white counter-value">{s.v}</div>
                                    <div className="text-xs text-emerald-400 mt-1">{s.c}</div>
                                </div>
                            ))}
                        </div>

                        {/* Графики */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div className="chart-container">
                                <canvas ref={chartRef1}></canvas>
                            </div>
                            <div className="chart-container">
                                <canvas ref={chartRef2}></canvas>
                            </div>
                        </div>
                        <div className="chart-container mb-8">
                            <canvas ref={chartRef3}></canvas>
                        </div>

                        {/* Топ отели */}
                        <div className="p-6 rounded-2xl border border-white/8" style={{background: 'rgba(255,255,255,0.02)'}}>
                            <h3 className="text-lg font-bold text-white mb-4 section-title">Топ отели по выручке</h3>
                            <div className="space-y-3">
                                {[
                                    {name:'Rixos Almaty',rev:'₸284,750',lots:47,pct:45},
                                    {name:'Hilton Astana',rev:'₸128,400',lots:23,pct:20},
                                    {name:'Marriott Almaty',rev:'₸89,200',lots:18,pct:14},
                                    {name:'Holiday Inn Almaty',rev:'₸29,650',lots:9,pct:5}
                                ].map((h,i) => (
                                    <div key={i} className="flex items-center gap-4">
                                        <div className="w-8 text-center text-sm font-bold text-gray-500">{i+1}</div>
                                        <div className="flex-1">
                                            <div className="flex justify-between mb-1">
                                                <span className="text-sm text-white font-semibold">{h.name}</span>
                                                <span className="text-sm text-white font-bold">{h.rev}</span>
                                            </div>
                                            <div className="w-full h-1.5 rounded-full bg-white/5">
                                                <div className="h-full rounded-full" style={{width: h.pct+'%', background: 'linear-gradient(90deg, #8EA99A, #5B8291)'}}></div>
                                            </div>
                                            <div className="text-xs text-gray-500 mt-1">{h.lots} лотов</div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Запуск приложения
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
